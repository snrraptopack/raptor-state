{"version":3,"file":"babel-plugin.js","sources":["babel/plugin/util.ts","babel/plugin/config.ts","babel/plugin/transform/reactHooks.ts","babel/plugin/transform/factory.ts","babel/plugin/transform/legacyDomainHooks.ts","babel/plugin/transform/hmr.ts","babel/plugin/templates.ts","babel/plugin/index.ts"],"sourcesContent":["import type {NodePath} from '@babel/traverse'\nimport type {PluginPass} from '@babel/core'\nimport type {\n  Identifier,\n  Expression,\n  PatternLike,\n  Program,\n  CallExpression,\n  ImportSpecifier,\n} from '@babel/types'\n\nimport type {\n  ImportNamesMap,\n  MethodParser,\n  PluginState,\n  SmallConfig,\n} from './types'\n\nexport const REGION_NAME = '_internalHMRRegion'\n\nexport function addFileNameIdentifier(\n  addLoc: boolean,\n  enableFileName: boolean,\n  t: typeof import('@babel/types'),\n  path: NodePath<any>,\n  state: PluginPass,\n) {\n  if (addLoc && !state.fileNameIdentifier) {\n    const fileName = enableFileName\n      ? stripRoot(state.file.opts.root || '', state.filename || '', false)\n      : ''\n\n    const fileNameIdentifier =\n      path.scope.generateUidIdentifier('_effectorFileName')\n    // babel bug https://github.com/babel/babel/issues/9496\n    if (path.hub) {\n      const scope = path.hub.getScope()\n      if (scope) {\n        scope.push({\n          id: fileNameIdentifier,\n          init: t.stringLiteral(fileName),\n        })\n      }\n    }\n    state.fileNameIdentifier = fileNameIdentifier\n  }\n}\n\nexport function addImport(\n  t: typeof import('@babel/types'),\n  path: NodePath<any>,\n  method: 'withFactory' | 'clearNode' | 'createNode' | 'withRegion',\n  importNamesMap: ImportNamesMap,\n) {\n  if (importNamesMap[method] !== null) {\n    return importNamesMap[method]!\n  }\n  const programPath = findProgramPath(path)\n  const uid = programPath.scope.generateUidIdentifier(method)\n  const specifier = t.importSpecifier(uid, t.identifier(method))\n  if (importNamesMap.importDeclaration === null) {\n    const importDeclaration = t.importDeclaration(\n      [specifier],\n      t.stringLiteral('effector'),\n    )\n    const [importPath] = programPath.unshiftContainer('body', importDeclaration)\n    importNamesMap.importDeclaration = importDeclaration\n    importNamesMap.importDeclarationPath = importPath\n  } else {\n    importNamesMap.importDeclaration.specifiers.push(specifier)\n  }\n  importNamesMap[method] = uid.name\n  return uid.name\n}\n\nexport function getImportedName(\n  t: typeof import('@babel/types'),\n  node: ImportSpecifier,\n) {\n  return t.isIdentifier(node.imported)\n    ? node.imported.name\n    : node.imported.value\n}\n\nexport function applyMethodParsers(\n  methodParsers: MethodParser[],\n  path: NodePath<any>,\n  state: PluginState,\n  name: string,\n) {\n  for (let i = 0; i < methodParsers.length; i++) {\n    const {flag, set, fn} = methodParsers[i]\n    if (flag && set.has(name)) {\n      fn(path, state, name, findCandidateNameForExpression(path))\n    }\n  }\n}\n\nexport function findCandidateNameForExpression(\n  path: NodePath<any>,\n): Identifier {\n  let id: Identifier | undefined\n  path.find(path => {\n    if (path.isAssignmentExpression()) {\n      id = path.node.left\n    } else if (path.isObjectProperty()) {\n      id = path.node.key\n    } else if (path.isVariableDeclarator()) {\n      id = path.node.id\n    } else if (path.isStatement()) {\n      // we've hit a statement, we should stop crawling up\n      return true\n    }\n\n    // we've got an id! no need to continue\n    if (id) return true\n    return false\n  })\n  return id!\n}\n\nexport function makeTrace(\n  fileNameIdentifier: Identifier,\n  lineNumber: number,\n  columnNumber: number,\n  t: typeof import('@babel/types'),\n) {\n  const fileLineLiteral = t.numericLiteral(lineNumber != null ? lineNumber : -1)\n  const fileColumnLiteral = t.numericLiteral(\n    columnNumber != null ? columnNumber : -1,\n  )\n\n  const fileProperty = property(t, 'file', fileNameIdentifier)\n  const lineProperty = property(t, 'line', fileLineLiteral)\n  const columnProperty = property(t, 'column', fileColumnLiteral)\n  return t.objectExpression([fileProperty, lineProperty, columnProperty])\n}\n\nfunction findLocArgs(path: NodePath) {\n  let loc: {line: number; column: number} | undefined\n  let args: CallExpression['arguments'] | undefined\n  path.find(path => {\n    if (path.isCallExpression()) {\n      args = path.node.arguments\n      loc = path.node.loc?.start\n      return true\n    }\n    return false\n  })\n  return {args, loc}\n}\n\nexport function setRestoreNameAfter(\n  path: NodePath,\n  state: PluginState,\n  nameNodeId: Identifier | null,\n  t: typeof import('@babel/types'),\n  {addLoc, addNames, debugSids}: SmallConfig,\n  checkBindingName?: string,\n) {\n  const displayName = nameNodeId ? nameNodeId.name : ''\n  if (isLocalVariable(path, checkBindingName)) return\n  const {args, loc} = findLocArgs(path)\n\n  if (args!) {\n    if (!args[0]) return\n    if (!args[1]) return\n    const oldConfig = args[2]\n    const configExpr = (args[2] = t.objectExpression([]))\n\n    const stableID = stringProperty(\n      t,\n      'sid',\n      generateStableID(\n        state.file.opts.root,\n        state.filename,\n        displayName,\n        loc!.line,\n        loc!.column,\n        debugSids,\n      ),\n    )\n\n    if (oldConfig) {\n      configExpr.properties.push(property(t, 'and', oldConfig))\n    }\n    if (addLoc) {\n      const locProp = property(\n        t,\n        'loc',\n        makeTrace(state.fileNameIdentifier!, loc!.line, loc!.column, t),\n      )\n      configExpr.properties.push(locProp)\n    }\n    if (displayName && addNames) {\n      configExpr.properties.push(stringProperty(t, 'name', displayName))\n    }\n    configExpr.properties.push(stableID)\n  }\n}\n\nexport function setStoreNameAfter(\n  path: NodePath,\n  state: PluginState,\n  nameNodeId: Identifier | null,\n  t: typeof import('@babel/types'),\n  {addLoc, addNames, debugSids}: SmallConfig,\n  fillFirstArg: boolean,\n  checkBindingName?: string,\n) {\n  const displayName = nameNodeId ? nameNodeId.name : ''\n  if (isLocalVariable(path, checkBindingName)) return\n  const {args, loc} = findLocArgs(path)\n\n  if (args!) {\n    if (!args[0]) {\n      if (!fillFirstArg) return\n      args[0] = t.nullLiteral()\n    }\n    const oldConfig = args[1]\n    const configExpr = (args[1] = t.objectExpression([]))\n\n    const stableID = stringProperty(\n      t,\n      'sid',\n      generateStableID(\n        state.file.opts.root,\n        state.filename,\n        displayName,\n        loc!.line,\n        loc!.column,\n        debugSids,\n      ),\n    )\n\n    if (oldConfig) {\n      configExpr.properties.push(property(t, 'and', oldConfig))\n    }\n    if (addLoc) {\n      const locProp = property(\n        t,\n        'loc',\n        makeTrace(state.fileNameIdentifier!, loc!.line, loc!.column, t),\n      )\n      configExpr.properties.push(locProp)\n    }\n    if (displayName && addNames) {\n      configExpr.properties.push(stringProperty(t, 'name', displayName))\n    }\n    configExpr.properties.push(stableID)\n  }\n}\n\nexport function isLocalVariable(\n  path: NodePath,\n  checkBindingName: string | undefined,\n) {\n  if (!checkBindingName) return false\n  const binding = path.scope.getBinding(checkBindingName)\n  if (binding) return binding.kind !== 'module'\n  return false\n}\n\nexport function setConfigForConfMethod(\n  path: NodePath,\n  state: PluginState,\n  nameNodeId: Identifier | null,\n  t: typeof import('@babel/types'),\n  {addLoc, addNames, debugSids}: SmallConfig,\n  singleArgument: boolean,\n  checkBindingName?: string,\n  allowEmptyArguments?: boolean,\n) {\n  const displayName = nameNodeId ? nameNodeId.name : ''\n  if (isLocalVariable(path, checkBindingName)) return\n  const {args, loc} = findLocArgs(path)\n\n  if (args!) {\n    if (!args[0] && !allowEmptyArguments) return\n    const commonArgs = singleArgument\n      ? args[0]\n      : t.arrayExpression(args.slice())\n    args.length = 0\n    const configExpr = t.objectExpression([])\n\n    const stableID = stringProperty(\n      t,\n      'sid',\n      generateStableID(\n        state.file.opts.root,\n        state.filename,\n        displayName,\n        loc!.line,\n        loc!.column,\n        debugSids,\n      ),\n    )\n\n    if (addLoc) {\n      const locProp = property(\n        t,\n        'loc',\n        makeTrace(state.fileNameIdentifier!, loc!.line, loc!.column, t),\n      )\n      configExpr.properties.push(locProp)\n    }\n    if (displayName && addNames) {\n      configExpr.properties.push(stringProperty(t, 'name', displayName))\n    }\n    configExpr.properties.push(stableID)\n    args[0] = t.objectExpression([\n      property(t, 'and', commonArgs),\n      property(t, 'or', configExpr),\n    ])\n  }\n}\n\nexport function setEventNameAfter(\n  path: NodePath,\n  state: PluginState,\n  nameNodeId: Identifier | null,\n  t: typeof import('@babel/types'),\n  {addLoc, addNames, debugSids}: SmallConfig,\n  checkBindingName?: string,\n) {\n  const displayName = nameNodeId ? nameNodeId.name : ''\n  if (isLocalVariable(path, checkBindingName)) return\n  const {args, loc} = findLocArgs(path)\n\n  if (args!) {\n    const firstArgument = args[0]\n    if (!firstArgument) {\n      if (displayName) {\n        args[0] = t.stringLiteral(displayName)\n      }\n    }\n    const oldConfig = args[1]\n    const configExpr = (args[firstArgument ? 1 : 0] = t.objectExpression([]))\n\n    const stableID = stringProperty(\n      t,\n      'sid',\n      generateStableID(\n        state.file.opts.root,\n        state.filename,\n        displayName,\n        loc!.line,\n        loc!.column,\n        debugSids,\n      ),\n    )\n\n    if (oldConfig) {\n      configExpr.properties.push(property(t, 'and', oldConfig))\n    }\n    if (addLoc) {\n      const locProp = property(\n        t,\n        'loc',\n        makeTrace(state.fileNameIdentifier!, loc!.line, loc!.column, t),\n      )\n      configExpr.properties.push(locProp)\n    }\n    if (displayName && addNames) {\n      configExpr.properties.push(stringProperty(t, 'name', displayName))\n    }\n    configExpr.properties.push(stableID)\n  }\n}\n\nexport function rememberLocalName(\n  importedName: string,\n  localName: string,\n  creatorsList: Set<string>[],\n) {\n  for (const creators of creatorsList) {\n    if (creators.has(importedName)) {\n      creators.add(localName)\n      return\n    }\n  }\n}\n\nexport function normalizeSource(\n  source: string,\n  rootPath: string,\n  state: PluginState,\n) {\n  let normalizedSource = source\n  if (normalizedSource.startsWith('.')) {\n    const {resolve, parse} = require('path')\n    const currentFile = state.filename || ''\n    const {dir} = parse(currentFile)\n    const resolvedImport = resolve(dir, normalizedSource)\n    normalizedSource = stripRoot(rootPath, resolvedImport, true)\n  }\n  return stripExtension(normalizedSource)\n}\n\nexport function stripExtension(path: string) {\n  const {extname} = require('path')\n  const ext = extname(path)\n  if (ext.length > 0) {\n    path = path.slice(0, -ext.length)\n  }\n  return path\n}\n\nexport function stripRoot(\n  babelRoot: string | null | undefined,\n  fileName: string | undefined,\n  omitFirstSlash: boolean,\n) {\n  const {sep, normalize} = require('path')\n  const rawPath = (fileName || '').replace(babelRoot || '', '')\n  let normalizedSeq = normalize(rawPath).split(sep)\n  if (omitFirstSlash && normalizedSeq.length > 0 && normalizedSeq[0] === '') {\n    normalizedSeq = normalizedSeq.slice(1)\n  }\n  const normalizedPath = normalizedSeq.join('/')\n  return normalizedPath\n}\n/**\n * \"foo src/index.js [12,30]\"\n */\nexport function generateStableID(\n  babelRoot: string | null | undefined,\n  fileName: string | undefined,\n  varName: string,\n  line: number,\n  column: number,\n  debugSids: boolean,\n) {\n  const normalizedPath = stripRoot(babelRoot, fileName, false)\n  const appendix = debugSids ? `:${normalizedPath}:${varName}` : ''\n  return (\n    hashCode(`${varName} ${normalizedPath} [${line}, ${column}]`) + appendix\n  )\n}\n\nfunction hashCode(s: string) {\n  let h = 0\n  let i = 0\n  if (s.length > 0)\n    while (i < s.length) h = ((h << 5) - h + s.charCodeAt(i++)) | 0\n  return h.toString(36)\n}\n\nexport function property(\n  t: typeof import('@babel/types'),\n  field: string,\n  content: Expression | PatternLike,\n) {\n  return t.objectProperty(t.identifier(field), content)\n}\n\nfunction stringProperty(\n  t: typeof import('@babel/types'),\n  field: string,\n  value: string,\n) {\n  return property(t, field, t.stringLiteral(value))\n}\n\nexport function findProgramPath(path: NodePath<any>) {\n  return path.find(path => path.isProgram())! as NodePath<Program>\n}\n","import type {\n  EffectorPluginOptions,\n  EffectorPluginOptionsNormalized,\n  MethodParser,\n  SmallConfig,\n} from './types'\nimport {\n  setConfigForConfMethod,\n  setEventNameAfter,\n  setRestoreNameAfter,\n  setStoreNameAfter,\n  stripExtension,\n} from './util'\n\nconst defaultFactories = [\n  '@farfetched/core',\n  '@effector/reflect',\n  '@effector/reflect/ssr',\n  '@effector/reflect/scope',\n  'atomic-router',\n  '@withease/factories',\n  'effector-action',\n  'patronum', // there is also custom handling for patronum/{method} imports\n]\n\nexport function normalizeOptions(options: EffectorPluginOptions) {\n  const defaults = options.noDefaults\n    ? {\n        store: [],\n        event: [],\n        effect: [],\n        domain: [],\n        restore: [],\n        combine: [],\n        sample: [],\n        forward: [],\n        guard: [],\n        attach: [],\n        split: [],\n        createApi: [],\n        merge: [],\n        domainMethods: {\n          store: [],\n          event: [],\n          effect: [],\n          domain: [],\n        },\n        reactMethods: {\n          createGate: [],\n        },\n        factories: [],\n      }\n    : {\n        store: ['createStore'],\n        event: ['createEvent'],\n        effect: ['createEffect'],\n        domain: ['createDomain'],\n        restore: ['restore'],\n        combine: ['combine'],\n        sample: ['sample'],\n        forward: ['forward'],\n        guard: ['guard'],\n        attach: ['attach'],\n        split: ['split'],\n        createApi: ['createApi'],\n        merge: ['merge'],\n        domainMethods: {\n          store: ['store', 'createStore'],\n          event: ['event', 'createEvent'],\n          effect: ['effect', 'createEffect'],\n          domain: ['domain', 'createDomain'],\n        },\n        reactMethods: {\n          createGate: ['createGate'],\n        },\n        factories: defaultFactories,\n      }\n  const fullConfig: EffectorPluginOptionsNormalized = readConfigFlags({\n    options,\n    properties: {\n      reactSsr: false,\n      transformLegacyDomainMethods: true,\n      forceScope: false,\n      filename: true,\n      stores: true,\n      events: true,\n      effects: true,\n      domains: true,\n      restores: true,\n      combines: true,\n      samples: true,\n      forwards: true,\n      guards: true,\n      attaches: true,\n      splits: true,\n      apis: true,\n      merges: true,\n      gates: true,\n    },\n    result: {\n      importName: new Set(\n        options.importName\n          ? Array.isArray(options.importName)\n            ? options.importName\n            : [options.importName]\n          : [\n              'effector',\n              'effector/compat',\n              'effector-root',\n              'effector-root/compat',\n              'effector-logger',\n              'trail/runtime',\n              '@effector/effector',\n            ],\n      ),\n      importReactNames: {\n        ssr: new Set(\n          readReactImportOption(options, 'ssr', [\n            'effector-react/scope',\n            'effector-react/ssr',\n          ]),\n        ),\n        nossr: new Set(\n          readReactImportOption(options, 'nossr', [\n            'effector-react',\n            'effector-react/compat',\n          ]),\n        ),\n      },\n      storeCreators: new Set(options.storeCreators || defaults.store),\n      eventCreators: new Set(options.eventCreators || defaults.event),\n      effectCreators: new Set(options.effectCreators || defaults.effect),\n      domainCreators: new Set(options.domainCreators || defaults.domain),\n      restoreCreators: new Set(options.restoreCreators || defaults.restore),\n      combineCreators: new Set(options.combineCreators || defaults.combine),\n      sampleCreators: new Set(options.sampleCreators || defaults.sample),\n      forwardCreators: new Set(options.forwardCreators || defaults.forward),\n      guardCreators: new Set(options.guardCreators || defaults.guard),\n      attachCreators: new Set(options.attachCreators || defaults.attach),\n      splitCreators: new Set(options.splitCreators || defaults.split),\n      apiCreators: new Set(options.apiCreators || defaults.createApi),\n      mergeCreators: new Set(options.mergeCreators || defaults.merge),\n      domainMethods: readConfigShape(\n        options.domainMethods,\n        defaults.domainMethods,\n      ),\n      reactMethods: readConfigShape(\n        options.reactMethods,\n        defaults.reactMethods,\n      ),\n      factories: [...(options.factories || []), ...defaults.factories].map(\n        stripExtension,\n      ),\n      addLoc: Boolean(options.addLoc),\n      debugSids: Boolean(options.debugSids),\n      forceScope: Boolean(options.forceScope),\n      hmr: options.hmr === 'none' ? false : options.hmr || false,\n      addNames:\n        typeof options.addNames !== 'undefined'\n          ? Boolean(options.addNames)\n          : true,\n    },\n  })\n\n  const creatorsList = [\n    fullConfig.storeCreators,\n    fullConfig.eventCreators,\n    fullConfig.effectCreators,\n    fullConfig.domainCreators,\n    fullConfig.restoreCreators,\n    fullConfig.combineCreators,\n    fullConfig.sampleCreators,\n    fullConfig.forwardCreators,\n    fullConfig.guardCreators,\n    fullConfig.attachCreators,\n    fullConfig.splitCreators,\n    fullConfig.apiCreators,\n    fullConfig.mergeCreators,\n  ]\n\n  return {\n    fullConfig,\n    creatorsList,\n  }\n}\n\nfunction readReactImportOption(\n  options: EffectorPluginOptions,\n  name: 'ssr' | 'nossr',\n  defaults: string[],\n) {\n  if (!options || !options.importReactNames) return defaults\n  const {importReactNames} = options\n  const value = importReactNames[name]\n  if (value) {\n    if (Array.isArray(value)) return value\n    else return [value]\n  }\n  return defaults\n}\n\nfunction readConfigShape<T extends Record<string, string[]>>(\n  shape: Record<string, any> = {},\n  defaults: T,\n) {\n  const result = {} as {\n    [K in keyof T]: Set<string>\n  }\n  for (const key in defaults) {\n    result[key] = readConfigArray(shape[key], defaults[key])\n  }\n  return result\n}\n\nfunction readConfigArray(array: string[] | undefined, defaults: string[]) {\n  return new Set(array || defaults)\n}\n\nfunction readConfigFlags({\n  options,\n  properties,\n  result,\n}: {\n  options: EffectorPluginOptions\n  properties: Record<string, boolean>\n  result: Record<string, any>\n}): any {\n  for (const property in properties) {\n    if (property in options) {\n      result[property] = Boolean(\n        options[property as keyof EffectorPluginOptions],\n      )\n    } else {\n      result[property] = properties[property]\n    }\n  }\n  return result\n}\n\nexport function getMethodParsers(\n  t: typeof import('@babel/types'),\n  smallConfig: SmallConfig,\n  {\n    stores,\n    events,\n    effects,\n    domains,\n    restores,\n    combines,\n    samples,\n    forwards,\n    guards,\n    attaches,\n    splits,\n    apis,\n    merges,\n    gates,\n\n    storeCreators,\n    eventCreators,\n    effectCreators,\n    domainCreators,\n    restoreCreators,\n    combineCreators,\n    sampleCreators,\n    forwardCreators,\n    guardCreators,\n    attachCreators,\n    splitCreators,\n    apiCreators,\n    mergeCreators,\n    domainMethods,\n    reactMethods,\n  }: {\n    stores: boolean\n    events: boolean\n    effects: boolean\n    domains: boolean\n    restores: boolean\n    combines: boolean\n    samples: boolean\n    forwards: boolean\n    guards: boolean\n    attaches: boolean\n    splits: boolean\n    apis: boolean\n    merges: boolean\n    gates: boolean\n\n    storeCreators: Set<string>\n    eventCreators: Set<string>\n    effectCreators: Set<string>\n    domainCreators: Set<string>\n    restoreCreators: Set<string>\n    combineCreators: Set<string>\n    sampleCreators: Set<string>\n    forwardCreators: Set<string>\n    guardCreators: Set<string>\n    attachCreators: Set<string>\n    splitCreators: Set<string>\n    apiCreators: Set<string>\n    mergeCreators: Set<string>\n    domainMethods: {\n      store: Set<string>\n      event: Set<string>\n      effect: Set<string>\n      domain: Set<string>\n    }\n    reactMethods: {\n      createGate: Set<string>\n    }\n  },\n) {\n  const methodParsers: MethodParser[] = [\n    {\n      flag: stores,\n      set: storeCreators,\n      fn: (path, state, name, id) =>\n        setStoreNameAfter(path, state, id, t, smallConfig, false, name),\n    },\n    {\n      flag: events,\n      set: eventCreators,\n      fn: (path, state, name, id) =>\n        setEventNameAfter(path, state, id, t, smallConfig, name),\n    },\n    {\n      flag: effects,\n      set: effectCreators,\n      fn: (path, state, name, id) =>\n        setEventNameAfter(path, state, id, t, smallConfig, name),\n    },\n    {\n      flag: domains,\n      set: domainCreators,\n      fn: (path, state, name, id) =>\n        setEventNameAfter(path, state, id, t, smallConfig, name),\n    },\n    {\n      flag: restores,\n      set: restoreCreators,\n      fn: (path, state, name, id) =>\n        setRestoreNameAfter(path, state, id, t, smallConfig, name),\n    },\n    {\n      flag: combines,\n      set: combineCreators,\n      fn: (path, state, name, id) =>\n        setConfigForConfMethod(path, state, id, t, smallConfig, false, name),\n    },\n    {\n      flag: samples,\n      set: sampleCreators,\n      fn: (path, state, name, id) =>\n        setConfigForConfMethod(path, state, id, t, smallConfig, false, name),\n    },\n    {\n      flag: forwards,\n      set: forwardCreators,\n      fn: (path, state, name, id) =>\n        setConfigForConfMethod(path, state, id, t, smallConfig, true, name),\n    },\n    {\n      flag: guards,\n      set: guardCreators,\n      fn: (path, state, name, id) =>\n        setConfigForConfMethod(path, state, id, t, smallConfig, false, name),\n    },\n    {\n      flag: attaches,\n      set: attachCreators,\n      fn: (path, state, name, id) =>\n        setConfigForConfMethod(path, state, id, t, smallConfig, true, name),\n    },\n    {\n      flag: splits,\n      set: splitCreators,\n      fn: (path, state, name, id) =>\n        setConfigForConfMethod(path, state, null, t, smallConfig, false, name),\n    },\n    {\n      flag: apis,\n      set: apiCreators,\n      fn: (path, state, name, id) =>\n        setConfigForConfMethod(path, state, null, t, smallConfig, false, name),\n    },\n    {\n      flag: merges,\n      set: mergeCreators,\n      fn: (path, state, name, id) =>\n        setStoreNameAfter(path, state, id, t, smallConfig, false, name),\n    },\n  ]\n  const domainMethodParsers: MethodParser[] = [\n    {\n      flag: stores,\n      set: domainMethods.store,\n      fn: (path, state, name, id) =>\n        setStoreNameAfter(path, state, id, t, smallConfig, false),\n    },\n    {\n      flag: events,\n      set: domainMethods.event,\n      fn: (path, state, name, id) =>\n        setEventNameAfter(path, state, id, t, smallConfig),\n    },\n    {\n      flag: effects,\n      set: domainMethods.effect,\n      fn: (path, state, name, id) =>\n        setEventNameAfter(path, state, id, t, smallConfig),\n    },\n    {\n      flag: domains,\n      set: domainMethods.domain,\n      fn: (path, state, name, id) =>\n        setEventNameAfter(path, state, id, t, smallConfig),\n    },\n  ]\n  const reactMethodParsers: MethodParser[] = [\n    {\n      flag: gates,\n      set: reactMethods.createGate,\n      fn: (path, state, name, id) =>\n        setConfigForConfMethod(\n          path,\n          state,\n          id,\n          t,\n          smallConfig,\n          false,\n          name,\n          true,\n        ),\n    },\n  ]\n  return {\n    methodParsers,\n    domainMethodParsers,\n    reactMethodParsers,\n  }\n}\n","import type {NodePath} from '@babel/traverse'\nimport type {CallExpression, ObjectExpression} from '@babel/types'\n\nimport type {MethodParser, PluginState} from '../types'\n\nimport {applyMethodParsers, getImportedName, property} from '../util'\n\nexport function transformReactHooks(\n  t: typeof import('@babel/types'),\n  name: string,\n  reactMethodParsers: MethodParser[],\n  forceScope: boolean,\n  path: NodePath<CallExpression>,\n  state: PluginState,\n) {\n  applyMethodParsers(reactMethodParsers, path, state, name)\n  transformReactForceScope(t, name, forceScope, path, state)\n}\n\nfunction transformReactForceScope(\n  t: typeof import('@babel/types'),\n  name: string,\n  forceScope: boolean,\n  path: NodePath<CallExpression>,\n  state: PluginState,\n) {\n  if (!forceScope || !state.effector_forceScopeSpecifiers.has(name)) return\n  const binding = path.scope.getBinding(name)\n  if (!binding || !t.isImportSpecifier(binding.path.node)) return\n  const hookName = getImportedName(t, binding.path.node)\n\n  switch (hookName) {\n    case 'useEvent':\n    case 'useStore':\n    case 'useUnit': {\n      if (!hasSecondArgument(path)) {\n        pushForceScopeToConfig(t, path)\n      }\n      break\n    }\n\n    case 'useList': {\n      if (!hasThirdArgument(path)) {\n        pushForceScopeToConfig(t, path)\n      }\n      break\n    }\n\n    case 'useGate': {\n      if (!hasThirdArgument(path)) {\n        // If no props passed\n        if (!hasSecondArgument(path)) {\n          path.node.arguments.push(t.objectExpression([]))\n        }\n        // Add forceScope: true\n        pushForceScopeToConfig(t, path)\n      }\n      break\n    }\n\n    case 'useStoreMap': {\n      if (hasSecondArgument(path)) {\n        const config = convertArgumentsToConfig(t, path, ['store', 'fn'])\n        path.node.arguments = [config]\n\n        // Add keys: []\n        config.properties.push(property(t, 'keys', t.arrayExpression()))\n        // Add forceScope: true\n        config.properties.push(\n          property(t, 'forceScope', t.booleanLiteral(true)),\n        )\n      } else {\n        const firstArg = path.node.arguments[0]\n        if (\n          t.isObjectExpression(firstArg) &&\n          !hasPropertyInConfig(t, firstArg, 'forceScope')\n        ) {\n          firstArg.properties.push(\n            property(t, 'forceScope', t.booleanLiteral(true)),\n          )\n        }\n      }\n      break\n    }\n  }\n}\n\nfunction hasSecondArgument(path: NodePath<CallExpression>) {\n  return path.node.arguments.length >= 2\n}\n\nfunction pushForceScopeToConfig(\n  t: typeof import('@babel/types'),\n  path: NodePath<CallExpression>,\n) {\n  path.node.arguments.push(\n    t.objectExpression([property(t, 'forceScope', t.booleanLiteral(true))]),\n  )\n}\n\nfunction hasThirdArgument(path: NodePath<CallExpression>) {\n  return path.node.arguments.length >= 3\n}\n\nfunction convertArgumentsToConfig(\n  t: typeof import('@babel/types'),\n  path: NodePath<CallExpression>,\n  argumentsAsKeys: string[],\n) {\n  const objectProperties = argumentsAsKeys.map((keyName, index) =>\n    t.objectProperty(\n      t.identifier(keyName),\n      t.cloneNode(path.node.arguments[index]),\n    ),\n  )\n  return t.objectExpression(objectProperties)\n}\n\nfunction hasPropertyInConfig(\n  t: typeof import('@babel/types'),\n  configNode: ObjectExpression,\n  propertyName: string,\n) {\n  return configNode.properties.some(\n    property =>\n      !t.isSpreadElement(property) &&\n      t.isIdentifier(property.key) &&\n      property.key.name === propertyName,\n  )\n}\n","import type {NodePath} from '@babel/traverse'\nimport type {CallExpression, TaggedTemplateExpression} from '@babel/types'\n\nimport type {FactoryTemplate, PluginState} from '../types'\n\nimport {\n  addImport,\n  findCandidateNameForExpression,\n  makeTrace,\n  generateStableID,\n} from '../util'\n\nexport function transformFactory(\n  t: typeof import('@babel/types'),\n  path: NodePath<CallExpression> | NodePath<TaggedTemplateExpression>,\n  state: PluginState,\n  factoriesUsed: boolean,\n  debugSids: boolean,\n  addLoc: boolean,\n  addNames: boolean,\n  factoryTemplate: FactoryTemplate,\n) {\n  const node: typeof path.node & {effector_isFactory?: boolean} = path.node\n  const isTaggedTemplate = t.isTaggedTemplateExpression(node)\n  const callee = isTaggedTemplate ? node.tag : node.callee\n  if (!t.isIdentifier(callee)) return\n  const name = callee.name\n  if (\n    !factoriesUsed ||\n    node.effector_isFactory ||\n    !state.effector_factoryMap.has(name)\n  ) {\n    return\n  }\n\n  const withFactoryImportName = addImport(\n    t,\n    path,\n    'withFactory',\n    state.effector_importNames,\n  )\n  const {importedName} = state.effector_factoryMap.get(name)!\n  node.effector_isFactory = true\n  const idNode = findCandidateNameForExpression(path)\n  const resultName = idNode ? idNode.name : ''\n  const nodeFinder = isTaggedTemplate\n    ? t.isTaggedTemplateExpression\n    : t.isCallExpression\n  let loc: {line: number; column: number} | undefined\n  path.find(path => {\n    if (nodeFinder(path.node)) {\n      if (path.node.loc) {\n        loc = path.node.loc.start\n      }\n      return true\n    }\n    return false\n  })\n  const sid = generateStableID(\n    state.file.opts.root,\n    state.filename,\n    resultName,\n    loc!.line,\n    loc!.column,\n    debugSids,\n  )\n  const factoryConfig: Parameters<FactoryTemplate>[0] = {\n    SID: JSON.stringify(sid),\n    FN: node,\n    FACTORY: withFactoryImportName,\n  }\n  if (addLoc || addNames) {\n    factoryConfig.NAME = JSON.stringify(\n      !resultName || resultName === '' ? 'none' : resultName,\n    )\n    factoryConfig.METHOD = JSON.stringify(importedName)\n  }\n  if (addLoc) {\n    factoryConfig.LOC = makeTrace(\n      state.fileNameIdentifier!,\n      loc!.line,\n      loc!.column,\n      t,\n    )\n  }\n  path.replaceWith(factoryTemplate(factoryConfig))\n}\n","import type {NodePath} from '@babel/traverse'\nimport type {CallExpression} from '@babel/types'\n\nimport type {MethodParser, PluginState} from '../types'\n\nimport {applyMethodParsers} from '../util'\n\nexport function processLegacyDomainHooks(\n  t: typeof import('@babel/types'),\n  domainMethodParsers: MethodParser[],\n  transformLegacyDomainMethods: boolean,\n  path: NodePath<CallExpression>,\n  state: PluginState,\n) {\n  if (\n    transformLegacyDomainMethods &&\n    t.isMemberExpression(path.node.callee) &&\n    'name' in path.node.callee.property\n  ) {\n    applyMethodParsers(\n      domainMethodParsers,\n      path,\n      state,\n      path.node.callee.property.name,\n    )\n  }\n}\n","import type {NodePath} from '@babel/traverse'\nimport type {\n  CallExpression,\n  TaggedTemplateExpression,\n  Program,\n} from '@babel/types'\n\nimport type {\n  CreateHMRRegionTemplate,\n  HotCodeTemplate,\n  ImportNamesMap,\n  WithRegionTemplate,\n} from '../types'\nimport {addImport, findProgramPath, REGION_NAME} from '../util'\n\nconst DEFAULT_WATCHED_CALLS = [\n  'map',\n  'filter',\n  'filterMap',\n  'subscribe',\n  'on',\n  'watch',\n  'reset',\n  'prepend',\n]\n\nconst SUPPORTED_NODES = [\n  'FunctionDeclaration',\n  'ArrowFunctionExpression',\n  'ExportDefaultDeclaration',\n  'ClassDeclaration',\n]\n\nexport function transformHmr(\n  t: typeof import('@babel/types'),\n  path: NodePath<Program>,\n  factories: string[],\n  importNamesMap: ImportNamesMap,\n  hmrMode: 'cjs' | 'es',\n  createHMRRegion: CreateHMRRegionTemplate,\n  createWithRegion: WithRegionTemplate,\n  createHotCode: HotCodeTemplate,\n) {\n  const watchedFactories = new Set(DEFAULT_WATCHED_CALLS)\n\n  path.traverse({\n    ImportDeclaration(declaration) {\n      const source = declaration.node.source.value\n      const specifiers = declaration.node.specifiers.map(\n        specifier => specifier.local.name,\n      )\n\n      if (!['effector', ...factories].includes(source)) {\n        return\n      }\n\n      for (const specifier of specifiers) {\n        watchedFactories.add(specifier)\n      }\n\n      if (source !== 'effector') {\n        return\n      }\n    },\n    CallExpression(path) {\n      applyHMRTransform(\n        t,\n        path,\n        path.node.callee,\n        watchedFactories,\n        importNamesMap,\n        hmrMode,\n        createHMRRegion,\n        createWithRegion,\n        createHotCode,\n      )\n    },\n    TaggedTemplateExpression(path) {\n      applyHMRTransform(\n        t,\n        path,\n        path.node.tag,\n        watchedFactories,\n        importNamesMap,\n        hmrMode,\n        createHMRRegion,\n        createWithRegion,\n        createHotCode,\n      )\n    },\n  })\n}\n\nfunction applyHMRTransform(\n  t: typeof import('@babel/types'),\n  path: NodePath<TaggedTemplateExpression> | NodePath<CallExpression>,\n  callee: CallExpression['callee'] | TaggedTemplateExpression['tag'],\n  watchedFactories: Set<string>,\n  importNamesMap: ImportNamesMap,\n  hmrMode: 'cjs' | 'es',\n  createHMRRegion: CreateHMRRegionTemplate,\n  createWithRegion: WithRegionTemplate,\n  createHotCode: HotCodeTemplate,\n) {\n  if (!isSupportHMR(path, callee, watchedFactories)) {\n    return\n  }\n  if (!importNamesMap.hmrRegionInserted) {\n    const createNodeName = addImport(t, path, 'createNode', importNamesMap)\n    const regionNode = createHMRRegion({\n      CREATE_NODE: createNodeName,\n      REGION_NAME,\n    })\n    /** guaranteed to be initialized after addImport call */\n    importNamesMap.importDeclarationPath!.insertAfter(regionNode)\n    importNamesMap.hmrRegionInserted = true\n  }\n  if (!importNamesMap.hmrCodeInserted) {\n    const hotCode = createHotCode(importNamesMap, path, hmrMode)\n    const programPath = findProgramPath(path)\n    programPath.pushContainer('body', hotCode)\n    importNamesMap.hmrCodeInserted = true\n  }\n  path.replaceWith(\n    createWithRegion({\n      WITH_REGION: addImport(t, path, 'withRegion', importNamesMap),\n      REGION_NAME,\n      FN: path.node,\n    }),\n  )\n}\n\nfunction isSupportHMR(\n  path: NodePath<any>,\n  callee: CallExpression['callee'] | TaggedTemplateExpression['tag'],\n  watchedFactories: Set<string>,\n) {\n  /** calls like `[foo]()`, who the hell even does that? */\n  if (\n    !('name' in callee) &&\n    !((callee as any).property && (callee as any).property.name)\n  ) {\n    return false\n  }\n  const name = (callee as any).name || (callee as any).property?.name\n  if (!watchedFactories.has(name)) {\n    return false\n  }\n  return !path.findParent(\n    parent => parent && SUPPORTED_NODES.includes(parent.node.type),\n  )\n}\n","import type {ExpressionStatement} from '@babel/types'\nimport type {NodePath} from '@babel/traverse'\nimport type {\n  CreateHMRRegionTemplate,\n  FactoryTemplate,\n  WithRegionTemplate,\n  HotCodeSyntaxTemplate,\n  HotCodeTemplate,\n  ImportNamesMap,\n} from './types'\nimport {addImport, REGION_NAME} from './util'\n\nexport function createFactoryTemplate(\n  template: typeof import('@babel/core')['template'],\n  addLoc: boolean,\n  addNames: boolean,\n): FactoryTemplate {\n  let factoryTemplate: FactoryTemplate | null = null\n  return args => {\n    if (!factoryTemplate) {\n      factoryTemplate = template(\n        addLoc\n          ? 'FACTORY({sid: SID,fn:()=>FN,name:NAME,method:METHOD,loc:LOC})'\n          : addNames\n          ? 'FACTORY({sid: SID,fn:()=>FN,name:NAME,method:METHOD})'\n          : 'FACTORY({sid: SID,fn:()=>FN})',\n      ) as any as FactoryTemplate\n    }\n    return factoryTemplate(args)\n  }\n}\n\nexport function createWithRegionTemplate(\n  template: typeof import('@babel/core')['template'],\n): WithRegionTemplate {\n  let withRegionTemplate: WithRegionTemplate | null = null\n  return args => {\n    if (!withRegionTemplate) {\n      withRegionTemplate = template(\n        'WITH_REGION(REGION_NAME, () => FN)',\n      ) as any as WithRegionTemplate\n    }\n    return withRegionTemplate(args)\n  }\n}\n\nexport function createHMRRegionTemplate(\n  template: typeof import('@babel/core')['template'],\n): CreateHMRRegionTemplate {\n  let hmrRegionTemplate: CreateHMRRegionTemplate | null = null\n  return args => {\n    if (!hmrRegionTemplate) {\n      hmrRegionTemplate = template(\n        'const REGION_NAME = CREATE_NODE({regional: true})',\n      ) as any as CreateHMRRegionTemplate\n    }\n    return hmrRegionTemplate(args)\n  }\n}\n\nexport function createHotCodeTemplate(\n  template: typeof import('@babel/core')['template'],\n  t: typeof import('@babel/types'),\n): HotCodeTemplate {\n  let hotProperty: ExpressionStatement\n  let hotCodeTemplate: HotCodeSyntaxTemplate | null = null\n  return (importNamesMap, declaration, hmrMode) => {\n    if (!hotProperty) {\n      hotProperty = template.expression.ast(\n        hmrMode === 'cjs'\n          ? 'module.hot'\n          : '(import.meta.hot || import.meta.webpackHot)',\n      ) as any as ExpressionStatement\n    }\n    if (!hotCodeTemplate) {\n      hotCodeTemplate = template(`\n        if (HOT_PROPERTY) {\n          HOT_PROPERTY.dispose(() => CLEAR_NODE(REGION_NAME));\n        } else {\n          console.warn('[effector hmr] HMR is not available in current environment.');\n        }\n      `) as any as HotCodeSyntaxTemplate\n    }\n    return hotCodeTemplate({\n      HOT_PROPERTY: hotProperty,\n      CLEAR_NODE: addImport(t, declaration, 'clearNode', importNamesMap),\n      REGION_NAME,\n    })\n  }\n}\n","import type {NodePath, Visitor} from '@babel/traverse'\nimport type {CallExpression} from '@babel/types'\nimport type {PluginObj} from '@babel/core'\n\nimport type {\n  SmallConfig,\n  MethodParser,\n  PluginState,\n  EffectorPluginOptions,\n} from './types'\n\nimport {\n  addFileNameIdentifier,\n  applyMethodParsers,\n  normalizeSource,\n  stripRoot,\n  rememberLocalName,\n  getImportedName,\n} from './util'\nimport {getMethodParsers, normalizeOptions} from './config'\nimport {transformReactHooks} from './transform/reactHooks'\nimport {transformFactory} from './transform/factory'\nimport {processLegacyDomainHooks} from './transform/legacyDomainHooks'\nimport {transformHmr} from './transform/hmr'\nimport {\n  createFactoryTemplate,\n  createWithRegionTemplate,\n  createHMRRegionTemplate,\n  createHotCodeTemplate,\n} from './templates'\n\nexport default function effectorBabelPlugin(\n  babel: typeof import('@babel/core'),\n  options: EffectorPluginOptions = {},\n) {\n  const {fullConfig, creatorsList} = normalizeOptions(options)\n  const {\n    addNames,\n    addLoc,\n    debugSids,\n    transformLegacyDomainMethods,\n    hmr,\n    filename: enableFileName,\n    reactMethods,\n    factories,\n    importName,\n    importReactNames,\n    reactSsr,\n    forceScope,\n  } = fullConfig\n  if (reactSsr) {\n    console.error(\n      '[effector/babel-plugin]: reactSsr option is deprecated, use imports from \"effector-react\" without aliases or /scope',\n    )\n  }\n  const factoriesUsed = factories.length > 0\n  const hasRelativeFactories = factories.some(\n    fab => fab.startsWith('./') || fab.startsWith('../'),\n  )\n\n  const smallConfig: SmallConfig = {addLoc, addNames, debugSids}\n  const {types: t, template} = babel\n  const factoryTemplate = createFactoryTemplate(template, addLoc, addNames)\n  const hmrRegionTemplate = createHMRRegionTemplate(template)\n  const withRegionTemplate = createWithRegionTemplate(template)\n  const hotCodeTemplate = createHotCodeTemplate(template, t)\n\n  const {methodParsers, reactMethodParsers, domainMethodParsers} =\n    getMethodParsers(t, smallConfig, fullConfig)\n\n  const importVisitor: Visitor<PluginState> = {\n    ImportDeclaration(path, state) {\n      const source = path.node.source.value\n      const specifiers = path.node.specifiers\n      if (importName.has(source)) {\n        for (let i = 0; i < specifiers.length; i++) {\n          const s = specifiers[i]\n          if (!t.isImportSpecifier(s)) continue\n          const importedName = getImportedName(t, s)\n          const localName = s.local.name\n          if (importedName === localName) continue\n          rememberLocalName(importedName, localName, creatorsList)\n        }\n      } else if (\n        importReactNames.ssr.has(source) ||\n        importReactNames.nossr.has(source)\n      ) {\n        for (let i = 0; i < specifiers.length; i++) {\n          const s = specifiers[i]\n          if (!t.isImportSpecifier(s)) continue\n          const importedName = getImportedName(t, s)\n          const localName = s.local.name\n\n          // effector-react/scope already forced scope\n          if (importReactNames.nossr.has(source)) {\n            this.effector_forceScopeSpecifiers.add(localName)\n          }\n\n          if (importedName === localName) continue\n          if (reactMethods.createGate.has(importedName)) {\n            reactMethods.createGate.add(localName)\n          }\n        }\n      } else {\n        for (let i = 0; i < specifiers.length; i++) {\n          const s = specifiers[i]\n          if (t.isImportNamespaceSpecifier(s)) continue\n          const localName = s.local.name\n          if (creatorsList.some(set => set.has(localName))) {\n            this.effector_ignoredImports.add(localName)\n          }\n        }\n      }\n      if (reactSsr) {\n        if (source === 'effector-react' || source === 'effector-react/compat') {\n          path.node.source.value = 'effector-react/scope'\n        }\n      }\n      if (factoriesUsed) {\n        const rootPath = state.file.opts.root || ''\n        if (!this.effector_factoryPaths) {\n          if (hasRelativeFactories) {\n            const {resolve} = require('path')\n            this.effector_factoryPaths = factories.map(fab => {\n              if (fab.startsWith('./') || fab.startsWith('../')) {\n                const resolvedFab = resolve(rootPath, fab)\n                return stripRoot(rootPath, resolvedFab, true)\n              }\n              return fab\n            })\n          } else {\n            this.effector_factoryPaths = factories\n          }\n        }\n        const normalizedSource = normalizeSource(source, rootPath, state)\n        if (\n          this.effector_factoryPaths.includes(normalizedSource) ||\n          // custom handling for patronum/{method} imports\n          normalizedSource.startsWith('patronum/')\n        ) {\n          this.effector_needFactoryImport = true\n\n          for (let i = 0; i < specifiers.length; i++) {\n            const s = specifiers[i]\n            if (t.isImportNamespaceSpecifier(s)) continue\n            const importedName = t.isImportDefaultSpecifier(s)\n              ? 'default'\n              : getImportedName(t, s)\n            const localName = s.local.name\n            this.effector_factoryMap.set(localName, {\n              localName,\n              importedName,\n              source: normalizedSource,\n            })\n          }\n        }\n      }\n    },\n  }\n\n  const plugin: PluginObj<PluginState> = {\n    name: 'effector/babel-plugin',\n    pre() {\n      this.effector_ignoredImports = new Set()\n      this.effector_forceScopeSpecifiers = new Set()\n      this.effector_factoryMap = new Map()\n      this.effector_importNames = {\n        withFactory: null,\n        clearNode: null,\n        createNode: null,\n        withRegion: null,\n        importDeclaration: null,\n        importDeclarationPath: null,\n        hmrRegionInserted: false,\n        hmrCodeInserted: false,\n      }\n    },\n    post() {\n      this.effector_ignoredImports.clear()\n      this.effector_factoryMap.clear()\n      this.effector_needFactoryImport = false\n      this.effector_importNames = {\n        withFactory: null,\n        clearNode: null,\n        createNode: null,\n        withRegion: null,\n        importDeclaration: null,\n        importDeclarationPath: null,\n        hmrRegionInserted: false,\n        hmrCodeInserted: false,\n      }\n      if (this.effector_factoryPaths) {\n        delete this.effector_factoryPaths\n      }\n    },\n    visitor: {\n      Program: {\n        enter(path, state) {\n          if (hmr) {\n            const hmrMode =\n              hmr === 'cjs'\n                ? 'cjs'\n                : hmr === 'es'\n                ? 'es'\n                : !!state.file.opts.caller?.supportsStaticESM\n                ? 'es'\n                : 'cjs'\n            transformHmr(\n              t,\n              path,\n              factories,\n              this.effector_importNames,\n              hmrMode,\n              hmrRegionTemplate,\n              withRegionTemplate,\n              hotCodeTemplate,\n            )\n          }\n\n          path.traverse(importVisitor, state)\n        },\n      },\n      CallExpression(path, state) {\n        addFileNameIdentifier(addLoc, enableFileName, t, path, state)\n\n        processLegacyDomainHooks(\n          t,\n          domainMethodParsers,\n          transformLegacyDomainMethods,\n          path,\n          state,\n        )\n        const name = getNonIgnoredCalee(t, path, state)\n        if (name) {\n          transformReactHooks(\n            t,\n            name,\n            reactMethodParsers,\n            forceScope,\n            path,\n            state,\n          )\n          processEffectorCommonMethods(name, methodParsers, path, state)\n        }\n\n        transformFactory(\n          t,\n          path,\n          state,\n          factoriesUsed,\n          debugSids,\n          addLoc,\n          addNames,\n          factoryTemplate,\n        )\n      },\n      TaggedTemplateExpression(path, state) {\n        addFileNameIdentifier(addLoc, enableFileName, t, path, state)\n\n        transformFactory(\n          t,\n          path,\n          state,\n          factoriesUsed,\n          debugSids,\n          addLoc,\n          addNames,\n          factoryTemplate,\n        )\n      },\n    },\n  }\n  return plugin\n}\n\nfunction getNonIgnoredCalee(\n  t: typeof import('@babel/types'),\n  path: NodePath<CallExpression>,\n  state: PluginState,\n) {\n  if (!t.isIdentifier(path.node.callee)) return null\n  const name = path.node.callee.name\n  if (state.effector_ignoredImports.has(name)) return null\n  return name\n}\n\nfunction processEffectorCommonMethods(\n  name: string,\n  methodParsers: MethodParser[],\n  path: NodePath<CallExpression>,\n  state: PluginState,\n) {\n  applyMethodParsers(methodParsers, path, state, name)\n}\n"],"names":["REGION_NAME","addFileNameIdentifier","addLoc","enableFileName","t","path","state","fileNameIdentifier","fileName","stripRoot","file","opts","root","filename","scope","generateUidIdentifier","hub","getScope","push","id","init","stringLiteral","addImport","method","importNamesMap","programPath","findProgramPath","uid","specifier","importSpecifier","identifier","importDeclaration","importPath","unshiftContainer","importDeclarationPath","specifiers","name","getImportedName","node","isIdentifier","imported","value","applyMethodParsers","methodParsers","i","length","flag","set","fn","has","findCandidateNameForExpression","find","isAssignmentExpression","left","isObjectProperty","key","isVariableDeclarator","isStatement","makeTrace","lineNumber","columnNumber","fileLineLiteral","numericLiteral","fileColumnLiteral","fileProperty","property","lineProperty","columnProperty","objectExpression","findLocArgs","loc","args","isCallExpression","_path$node$loc","arguments","start","setRestoreNameAfter","nameNodeId","addNames","debugSids","checkBindingName","displayName","isLocalVariable","oldConfig","configExpr","stableID","stringProperty","generateStableID","line","column","properties","locProp","setStoreNameAfter","fillFirstArg","nullLiteral","binding","getBinding","kind","setConfigForConfMethod","singleArgument","allowEmptyArguments","commonArgs","arrayExpression","slice","setEventNameAfter","firstArgument","rememberLocalName","importedName","localName","creatorsList","creators","add","normalizeSource","source","rootPath","normalizedSource","startsWith","resolve","parse","require","currentFile","dir","resolvedImport","stripExtension","extname","ext","babelRoot","omitFirstSlash","sep","normalize","rawPath","replace","normalizedSeq","split","normalizedPath","join","varName","appendix","hashCode","s","h","charCodeAt","toString","field","content","objectProperty","isProgram","defaultFactories","normalizeOptions","options","defaults","noDefaults","store","event","effect","domain","restore","combine","sample","forward","guard","attach","createApi","merge","domainMethods","reactMethods","createGate","factories","fullConfig","readConfigFlags","reactSsr","transformLegacyDomainMethods","forceScope","stores","events","effects","domains","restores","combines","samples","forwards","guards","attaches","splits","apis","merges","gates","result","importName","Set","Array","isArray","importReactNames","ssr","readReactImportOption","nossr","storeCreators","eventCreators","effectCreators","domainCreators","restoreCreators","combineCreators","sampleCreators","forwardCreators","guardCreators","attachCreators","splitCreators","apiCreators","mergeCreators","readConfigShape","map","Boolean","hmr","shape","readConfigArray","array","getMethodParsers","smallConfig","domainMethodParsers","reactMethodParsers","transformReactHooks","transformReactForceScope","effector_forceScopeSpecifiers","isImportSpecifier","hookName","hasSecondArgument","pushForceScopeToConfig","hasThirdArgument","config","convertArgumentsToConfig","booleanLiteral","firstArg","isObjectExpression","hasPropertyInConfig","argumentsAsKeys","objectProperties","keyName","index","cloneNode","configNode","propertyName","some","isSpreadElement","transformFactory","factoriesUsed","factoryTemplate","isTaggedTemplate","isTaggedTemplateExpression","callee","tag","effector_isFactory","effector_factoryMap","withFactoryImportName","effector_importNames","get","idNode","resultName","nodeFinder","sid","factoryConfig","SID","JSON","stringify","FN","FACTORY","NAME","METHOD","LOC","replaceWith","processLegacyDomainHooks","isMemberExpression","DEFAULT_WATCHED_CALLS","SUPPORTED_NODES","transformHmr","hmrMode","createHMRRegion","createWithRegion","createHotCode","watchedFactories","traverse","ImportDeclaration","declaration","local","includes","CallExpression","applyHMRTransform","TaggedTemplateExpression","isSupportHMR","hmrRegionInserted","createNodeName","regionNode","CREATE_NODE","insertAfter","hmrCodeInserted","hotCode","pushContainer","WITH_REGION","_property","findParent","parent","type","createFactoryTemplate","template","createWithRegionTemplate","withRegionTemplate","createHMRRegionTemplate","hmrRegionTemplate","createHotCodeTemplate","hotProperty","hotCodeTemplate","expression","ast","HOT_PROPERTY","CLEAR_NODE","effectorBabelPlugin","babel","console","error","hasRelativeFactories","fab","types","importVisitor","isImportNamespaceSpecifier","effector_ignoredImports","effector_factoryPaths","resolvedFab","effector_needFactoryImport","isImportDefaultSpecifier","plugin","pre","Map","withFactory","clearNode","createNode","withRegion","post","clear","visitor","Program","enter","_state$file$opts$call","caller","supportsStaticESM","getNonIgnoredCalee","processEffectorCommonMethods"],"mappings":";;AAkBO,MAAMA,WAAW,GAAG,oBAAoB;AAExC,SAASC,qBAAqBA,CACnCC,MAAe,EACfC,cAAuB,EACvBC,CAAgC,EAChCC,IAAmB,EACnBC,KAAiB,EACjB;EACA,IAAIJ,MAAM,IAAI,CAACI,KAAK,CAACC,kBAAkB,EAAE;IACvC,MAAMC,QAAQ,GAAGL,cAAc,GAC3BM,SAAS,CAACH,KAAK,CAACI,IAAI,CAACC,IAAI,CAACC,IAAI,IAAI,EAAE,EAAEN,KAAK,CAACO,QAAQ,IAAI,EAAE,EAAE,KAAK,CAAC,GAClE,EAAE;IAEN,MAAMN,kBAAkB,GACtBF,IAAI,CAACS,KAAK,CAACC,qBAAqB,CAAC,mBAAmB,CAAC;;IAEvD,IAAIV,IAAI,CAACW,GAAG,EAAE;MACZ,MAAMF,KAAK,GAAGT,IAAI,CAACW,GAAG,CAACC,QAAQ,EAAE;MACjC,IAAIH,KAAK,EAAE;QACTA,KAAK,CAACI,IAAI,CAAC;UACTC,EAAE,EAAEZ,kBAAkB;UACtBa,IAAI,EAAEhB,CAAC,CAACiB,aAAa,CAACb,QAAQ;SAC/B,CAAC;;;IAGNF,KAAK,CAACC,kBAAkB,GAAGA,kBAAkB;;AAEjD;AAEO,SAASe,SAASA,CACvBlB,CAAgC,EAChCC,IAAmB,EACnBkB,MAAiE,EACjEC,cAA8B,EAC9B;EACA,IAAIA,cAAc,CAACD,MAAM,CAAC,KAAK,IAAI,EAAE;IACnC,OAAOC,cAAc,CAACD,MAAM,CAAC;;EAE/B,MAAME,WAAW,GAAGC,eAAe,CAACrB,IAAI,CAAC;EACzC,MAAMsB,GAAG,GAAGF,WAAW,CAACX,KAAK,CAACC,qBAAqB,CAACQ,MAAM,CAAC;EAC3D,MAAMK,SAAS,GAAGxB,CAAC,CAACyB,eAAe,CAACF,GAAG,EAAEvB,CAAC,CAAC0B,UAAU,CAACP,MAAM,CAAC,CAAC;EAC9D,IAAIC,cAAc,CAACO,iBAAiB,KAAK,IAAI,EAAE;IAC7C,MAAMA,iBAAiB,GAAG3B,CAAC,CAAC2B,iBAAiB,CAC3C,CAACH,SAAS,CAAC,EACXxB,CAAC,CAACiB,aAAa,CAAC,UAAU,CAC5B,CAAC;IACD,MAAM,CAACW,UAAU,CAAC,GAAGP,WAAW,CAACQ,gBAAgB,CAAC,MAAM,EAAEF,iBAAiB,CAAC;IAC5EP,cAAc,CAACO,iBAAiB,GAAGA,iBAAiB;IACpDP,cAAc,CAACU,qBAAqB,GAAGF,UAAU;GAClD,MAAM;IACLR,cAAc,CAACO,iBAAiB,CAACI,UAAU,CAACjB,IAAI,CAACU,SAAS,CAAC;;EAE7DJ,cAAc,CAACD,MAAM,CAAC,GAAGI,GAAG,CAACS,IAAI;EACjC,OAAOT,GAAG,CAACS,IAAI;AACjB;AAEO,SAASC,eAAeA,CAC7BjC,CAAgC,EAChCkC,IAAqB,EACrB;EACA,OAAOlC,CAAC,CAACmC,YAAY,CAACD,IAAI,CAACE,QAAQ,CAAC,GAChCF,IAAI,CAACE,QAAQ,CAACJ,IAAI,GAClBE,IAAI,CAACE,QAAQ,CAACC,KAAK;AACzB;AAEO,SAASC,kBAAkBA,CAChCC,aAA6B,EAC7BtC,IAAmB,EACnBC,KAAkB,EAClB8B,IAAY,EACZ;EACA,KAAK,IAAIQ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,aAAa,CAACE,MAAM,EAAED,CAAC,EAAE,EAAE;IAC7C,MAAM;MAACE,IAAI;MAAEC,GAAG;MAAEC;KAAG,GAAGL,aAAa,CAACC,CAAC,CAAC;IACxC,IAAIE,IAAI,IAAIC,GAAG,CAACE,GAAG,CAACb,IAAI,CAAC,EAAE;MACzBY,EAAE,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEc,8BAA8B,CAAC7C,IAAI,CAAC,CAAC;;;AAGjE;AAEO,SAAS6C,8BAA8BA,CAC5C7C,IAAmB,EACP;EACZ,IAAIc,EAA0B;EAC9Bd,IAAI,CAAC8C,IAAI,CAAC9C,IAAI,IAAI;IAChB,IAAIA,IAAI,CAAC+C,sBAAsB,EAAE,EAAE;MACjCjC,EAAE,GAAGd,IAAI,CAACiC,IAAI,CAACe,IAAI;KACpB,MAAM,IAAIhD,IAAI,CAACiD,gBAAgB,EAAE,EAAE;MAClCnC,EAAE,GAAGd,IAAI,CAACiC,IAAI,CAACiB,GAAG;KACnB,MAAM,IAAIlD,IAAI,CAACmD,oBAAoB,EAAE,EAAE;MACtCrC,EAAE,GAAGd,IAAI,CAACiC,IAAI,CAACnB,EAAE;KAClB,MAAM,IAAId,IAAI,CAACoD,WAAW,EAAE,EAAE;;MAE7B,OAAO,IAAI;;;;IAIb,IAAItC,EAAE,EAAE,OAAO,IAAI;IACnB,OAAO,KAAK;GACb,CAAC;EACF,OAAOA,EAAE;AACX;AAEO,SAASuC,SAASA,CACvBnD,kBAA8B,EAC9BoD,UAAkB,EAClBC,YAAoB,EACpBxD,CAAgC,EAChC;EACA,MAAMyD,eAAe,GAAGzD,CAAC,CAAC0D,cAAc,CAACH,UAAU,IAAI,IAAI,GAAGA,UAAU,GAAG,CAAC,CAAC,CAAC;EAC9E,MAAMI,iBAAiB,GAAG3D,CAAC,CAAC0D,cAAc,CACxCF,YAAY,IAAI,IAAI,GAAGA,YAAY,GAAG,CAAC,CACzC,CAAC;EAED,MAAMI,YAAY,GAAGC,QAAQ,CAAC7D,CAAC,EAAE,MAAM,EAAEG,kBAAkB,CAAC;EAC5D,MAAM2D,YAAY,GAAGD,QAAQ,CAAC7D,CAAC,EAAE,MAAM,EAAEyD,eAAe,CAAC;EACzD,MAAMM,cAAc,GAAGF,QAAQ,CAAC7D,CAAC,EAAE,QAAQ,EAAE2D,iBAAiB,CAAC;EAC/D,OAAO3D,CAAC,CAACgE,gBAAgB,CAAC,CAACJ,YAAY,EAAEE,YAAY,EAAEC,cAAc,CAAC,CAAC;AACzE;AAEA,SAASE,WAAWA,CAAChE,IAAc,EAAE;EACnC,IAAIiE,GAA+C;EACnD,IAAIC,IAA6C;EACjDlE,IAAI,CAAC8C,IAAI,CAAC9C,IAAI,IAAI;IAChB,IAAIA,IAAI,CAACmE,gBAAgB,EAAE,EAAE;MAAA,IAAAC,cAAA;MAC3BF,IAAI,GAAGlE,IAAI,CAACiC,IAAI,CAACoC,SAAS;MAC1BJ,GAAG,IAAAG,cAAA,GAAGpE,IAAI,CAACiC,IAAI,CAACgC,GAAG,cAAAG,cAAA,uBAAbA,cAAA,CAAeE,KAAK;MAC1B,OAAO,IAAI;;IAEb,OAAO,KAAK;GACb,CAAC;EACF,OAAO;IAACJ,IAAI;IAAED;GAAI;AACpB;AAEO,SAASM,mBAAmBA,CACjCvE,IAAc,EACdC,KAAkB,EAClBuE,UAA6B,EAC7BzE,CAAgC,EAChC;EAACF,MAAM;EAAE4E,QAAQ;EAAEC;AAAsB,CAAC,EAC1CC,gBAAyB,EACzB;EACA,MAAMC,WAAW,GAAGJ,UAAU,GAAGA,UAAU,CAACzC,IAAI,GAAG,EAAE;EACrD,IAAI8C,eAAe,CAAC7E,IAAI,EAAE2E,gBAAgB,CAAC,EAAE;EAC7C,MAAM;IAACT,IAAI;IAAED;GAAI,GAAGD,WAAW,CAAChE,IAAI,CAAC;EAErC,IAAIkE,IAAI,EAAG;IACT,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,EAAE;IACd,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,EAAE;IACd,MAAMY,SAAS,GAAGZ,IAAI,CAAC,CAAC,CAAC;IACzB,MAAMa,UAAU,GAAIb,IAAI,CAAC,CAAC,CAAC,GAAGnE,CAAC,CAACgE,gBAAgB,CAAC,EAAE,CAAE;IAErD,MAAMiB,QAAQ,GAAGC,cAAc,CAC7BlF,CAAC,EACD,KAAK,EACLmF,gBAAgB,CACdjF,KAAK,CAACI,IAAI,CAACC,IAAI,CAACC,IAAI,EACpBN,KAAK,CAACO,QAAQ,EACdoE,WAAW,EACXX,GAAG,CAAEkB,IAAI,EACTlB,GAAG,CAAEmB,MAAM,EACXV,SACF,CACF,CAAC;IAED,IAAII,SAAS,EAAE;MACbC,UAAU,CAACM,UAAU,CAACxE,IAAI,CAAC+C,QAAQ,CAAC7D,CAAC,EAAE,KAAK,EAAE+E,SAAS,CAAC,CAAC;;IAE3D,IAAIjF,MAAM,EAAE;MACV,MAAMyF,OAAO,GAAG1B,QAAQ,CACtB7D,CAAC,EACD,KAAK,EACLsD,SAAS,CAACpD,KAAK,CAACC,kBAAkB,EAAG+D,GAAG,CAAEkB,IAAI,EAAElB,GAAG,CAAEmB,MAAM,EAAErF,CAAC,CAChE,CAAC;MACDgF,UAAU,CAACM,UAAU,CAACxE,IAAI,CAACyE,OAAO,CAAC;;IAErC,IAAIV,WAAW,IAAIH,QAAQ,EAAE;MAC3BM,UAAU,CAACM,UAAU,CAACxE,IAAI,CAACoE,cAAc,CAAClF,CAAC,EAAE,MAAM,EAAE6E,WAAW,CAAC,CAAC;;IAEpEG,UAAU,CAACM,UAAU,CAACxE,IAAI,CAACmE,QAAQ,CAAC;;AAExC;AAEO,SAASO,iBAAiBA,CAC/BvF,IAAc,EACdC,KAAkB,EAClBuE,UAA6B,EAC7BzE,CAAgC,EAChC;EAACF,MAAM;EAAE4E,QAAQ;EAAEC;AAAsB,CAAC,EAC1Cc,YAAqB,EACrBb,gBAAyB,EACzB;EACA,MAAMC,WAAW,GAAGJ,UAAU,GAAGA,UAAU,CAACzC,IAAI,GAAG,EAAE;EACrD,IAAI8C,eAAe,CAAC7E,IAAI,EAAE2E,gBAAgB,CAAC,EAAE;EAC7C,MAAM;IAACT,IAAI;IAAED;GAAI,GAAGD,WAAW,CAAChE,IAAI,CAAC;EAErC,IAAIkE,IAAI,EAAG;IACT,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,EAAE;MACZ,IAAI,CAACsB,YAAY,EAAE;MACnBtB,IAAI,CAAC,CAAC,CAAC,GAAGnE,CAAC,CAAC0F,WAAW,EAAE;;IAE3B,MAAMX,SAAS,GAAGZ,IAAI,CAAC,CAAC,CAAC;IACzB,MAAMa,UAAU,GAAIb,IAAI,CAAC,CAAC,CAAC,GAAGnE,CAAC,CAACgE,gBAAgB,CAAC,EAAE,CAAE;IAErD,MAAMiB,QAAQ,GAAGC,cAAc,CAC7BlF,CAAC,EACD,KAAK,EACLmF,gBAAgB,CACdjF,KAAK,CAACI,IAAI,CAACC,IAAI,CAACC,IAAI,EACpBN,KAAK,CAACO,QAAQ,EACdoE,WAAW,EACXX,GAAG,CAAEkB,IAAI,EACTlB,GAAG,CAAEmB,MAAM,EACXV,SACF,CACF,CAAC;IAED,IAAII,SAAS,EAAE;MACbC,UAAU,CAACM,UAAU,CAACxE,IAAI,CAAC+C,QAAQ,CAAC7D,CAAC,EAAE,KAAK,EAAE+E,SAAS,CAAC,CAAC;;IAE3D,IAAIjF,MAAM,EAAE;MACV,MAAMyF,OAAO,GAAG1B,QAAQ,CACtB7D,CAAC,EACD,KAAK,EACLsD,SAAS,CAACpD,KAAK,CAACC,kBAAkB,EAAG+D,GAAG,CAAEkB,IAAI,EAAElB,GAAG,CAAEmB,MAAM,EAAErF,CAAC,CAChE,CAAC;MACDgF,UAAU,CAACM,UAAU,CAACxE,IAAI,CAACyE,OAAO,CAAC;;IAErC,IAAIV,WAAW,IAAIH,QAAQ,EAAE;MAC3BM,UAAU,CAACM,UAAU,CAACxE,IAAI,CAACoE,cAAc,CAAClF,CAAC,EAAE,MAAM,EAAE6E,WAAW,CAAC,CAAC;;IAEpEG,UAAU,CAACM,UAAU,CAACxE,IAAI,CAACmE,QAAQ,CAAC;;AAExC;AAEO,SAASH,eAAeA,CAC7B7E,IAAc,EACd2E,gBAAoC,EACpC;EACA,IAAI,CAACA,gBAAgB,EAAE,OAAO,KAAK;EACnC,MAAMe,OAAO,GAAG1F,IAAI,CAACS,KAAK,CAACkF,UAAU,CAAChB,gBAAgB,CAAC;EACvD,IAAIe,OAAO,EAAE,OAAOA,OAAO,CAACE,IAAI,KAAK,QAAQ;EAC7C,OAAO,KAAK;AACd;AAEO,SAASC,sBAAsBA,CACpC7F,IAAc,EACdC,KAAkB,EAClBuE,UAA6B,EAC7BzE,CAAgC,EAChC;EAACF,MAAM;EAAE4E,QAAQ;EAAEC;AAAsB,CAAC,EAC1CoB,cAAuB,EACvBnB,gBAAyB,EACzBoB,mBAA6B,EAC7B;EACA,MAAMnB,WAAW,GAAGJ,UAAU,GAAGA,UAAU,CAACzC,IAAI,GAAG,EAAE;EACrD,IAAI8C,eAAe,CAAC7E,IAAI,EAAE2E,gBAAgB,CAAC,EAAE;EAC7C,MAAM;IAACT,IAAI;IAAED;GAAI,GAAGD,WAAW,CAAChE,IAAI,CAAC;EAErC,IAAIkE,IAAI,EAAG;IACT,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC6B,mBAAmB,EAAE;IACtC,MAAMC,UAAU,GAAGF,cAAc,GAC7B5B,IAAI,CAAC,CAAC,CAAC,GACPnE,CAAC,CAACkG,eAAe,CAAC/B,IAAI,CAACgC,KAAK,EAAE,CAAC;IACnChC,IAAI,CAAC1B,MAAM,GAAG,CAAC;IACf,MAAMuC,UAAU,GAAGhF,CAAC,CAACgE,gBAAgB,CAAC,EAAE,CAAC;IAEzC,MAAMiB,QAAQ,GAAGC,cAAc,CAC7BlF,CAAC,EACD,KAAK,EACLmF,gBAAgB,CACdjF,KAAK,CAACI,IAAI,CAACC,IAAI,CAACC,IAAI,EACpBN,KAAK,CAACO,QAAQ,EACdoE,WAAW,EACXX,GAAG,CAAEkB,IAAI,EACTlB,GAAG,CAAEmB,MAAM,EACXV,SACF,CACF,CAAC;IAED,IAAI7E,MAAM,EAAE;MACV,MAAMyF,OAAO,GAAG1B,QAAQ,CACtB7D,CAAC,EACD,KAAK,EACLsD,SAAS,CAACpD,KAAK,CAACC,kBAAkB,EAAG+D,GAAG,CAAEkB,IAAI,EAAElB,GAAG,CAAEmB,MAAM,EAAErF,CAAC,CAChE,CAAC;MACDgF,UAAU,CAACM,UAAU,CAACxE,IAAI,CAACyE,OAAO,CAAC;;IAErC,IAAIV,WAAW,IAAIH,QAAQ,EAAE;MAC3BM,UAAU,CAACM,UAAU,CAACxE,IAAI,CAACoE,cAAc,CAAClF,CAAC,EAAE,MAAM,EAAE6E,WAAW,CAAC,CAAC;;IAEpEG,UAAU,CAACM,UAAU,CAACxE,IAAI,CAACmE,QAAQ,CAAC;IACpCd,IAAI,CAAC,CAAC,CAAC,GAAGnE,CAAC,CAACgE,gBAAgB,CAAC,CAC3BH,QAAQ,CAAC7D,CAAC,EAAE,KAAK,EAAEiG,UAAU,CAAC,EAC9BpC,QAAQ,CAAC7D,CAAC,EAAE,IAAI,EAAEgF,UAAU,CAAC,CAC9B,CAAC;;AAEN;AAEO,SAASoB,iBAAiBA,CAC/BnG,IAAc,EACdC,KAAkB,EAClBuE,UAA6B,EAC7BzE,CAAgC,EAChC;EAACF,MAAM;EAAE4E,QAAQ;EAAEC;AAAsB,CAAC,EAC1CC,gBAAyB,EACzB;EACA,MAAMC,WAAW,GAAGJ,UAAU,GAAGA,UAAU,CAACzC,IAAI,GAAG,EAAE;EACrD,IAAI8C,eAAe,CAAC7E,IAAI,EAAE2E,gBAAgB,CAAC,EAAE;EAC7C,MAAM;IAACT,IAAI;IAAED;GAAI,GAAGD,WAAW,CAAChE,IAAI,CAAC;EAErC,IAAIkE,IAAI,EAAG;IACT,MAAMkC,aAAa,GAAGlC,IAAI,CAAC,CAAC,CAAC;IAC7B,IAAI,CAACkC,aAAa,EAAE;MAClB,IAAIxB,WAAW,EAAE;QACfV,IAAI,CAAC,CAAC,CAAC,GAAGnE,CAAC,CAACiB,aAAa,CAAC4D,WAAW,CAAC;;;IAG1C,MAAME,SAAS,GAAGZ,IAAI,CAAC,CAAC,CAAC;IACzB,MAAMa,UAAU,GAAIb,IAAI,CAACkC,aAAa,GAAG,CAAC,GAAG,CAAC,CAAC,GAAGrG,CAAC,CAACgE,gBAAgB,CAAC,EAAE,CAAE;IAEzE,MAAMiB,QAAQ,GAAGC,cAAc,CAC7BlF,CAAC,EACD,KAAK,EACLmF,gBAAgB,CACdjF,KAAK,CAACI,IAAI,CAACC,IAAI,CAACC,IAAI,EACpBN,KAAK,CAACO,QAAQ,EACdoE,WAAW,EACXX,GAAG,CAAEkB,IAAI,EACTlB,GAAG,CAAEmB,MAAM,EACXV,SACF,CACF,CAAC;IAED,IAAII,SAAS,EAAE;MACbC,UAAU,CAACM,UAAU,CAACxE,IAAI,CAAC+C,QAAQ,CAAC7D,CAAC,EAAE,KAAK,EAAE+E,SAAS,CAAC,CAAC;;IAE3D,IAAIjF,MAAM,EAAE;MACV,MAAMyF,OAAO,GAAG1B,QAAQ,CACtB7D,CAAC,EACD,KAAK,EACLsD,SAAS,CAACpD,KAAK,CAACC,kBAAkB,EAAG+D,GAAG,CAAEkB,IAAI,EAAElB,GAAG,CAAEmB,MAAM,EAAErF,CAAC,CAChE,CAAC;MACDgF,UAAU,CAACM,UAAU,CAACxE,IAAI,CAACyE,OAAO,CAAC;;IAErC,IAAIV,WAAW,IAAIH,QAAQ,EAAE;MAC3BM,UAAU,CAACM,UAAU,CAACxE,IAAI,CAACoE,cAAc,CAAClF,CAAC,EAAE,MAAM,EAAE6E,WAAW,CAAC,CAAC;;IAEpEG,UAAU,CAACM,UAAU,CAACxE,IAAI,CAACmE,QAAQ,CAAC;;AAExC;AAEO,SAASqB,iBAAiBA,CAC/BC,YAAoB,EACpBC,SAAiB,EACjBC,YAA2B,EAC3B;EACA,KAAK,MAAMC,QAAQ,IAAID,YAAY,EAAE;IACnC,IAAIC,QAAQ,CAAC7D,GAAG,CAAC0D,YAAY,CAAC,EAAE;MAC9BG,QAAQ,CAACC,GAAG,CAACH,SAAS,CAAC;MACvB;;;AAGN;AAEO,SAASI,eAAeA,CAC7BC,MAAc,EACdC,QAAgB,EAChB5G,KAAkB,EAClB;EACA,IAAI6G,gBAAgB,GAAGF,MAAM;EAC7B,IAAIE,gBAAgB,CAACC,UAAU,CAAC,GAAG,CAAC,EAAE;IACpC,MAAM;MAACC,OAAO;MAAEC;KAAM,GAAGC,OAAO,CAAC,MAAM,CAAC;IACxC,MAAMC,WAAW,GAAGlH,KAAK,CAACO,QAAQ,IAAI,EAAE;IACxC,MAAM;MAAC4G;KAAI,GAAGH,KAAK,CAACE,WAAW,CAAC;IAChC,MAAME,cAAc,GAAGL,OAAO,CAACI,GAAG,EAAEN,gBAAgB,CAAC;IACrDA,gBAAgB,GAAG1G,SAAS,CAACyG,QAAQ,EAAEQ,cAAc,EAAE,IAAI,CAAC;;EAE9D,OAAOC,cAAc,CAACR,gBAAgB,CAAC;AACzC;AAEO,SAASQ,cAAcA,CAACtH,IAAY,EAAE;EAC3C,MAAM;IAACuH;GAAQ,GAAGL,OAAO,CAAC,MAAM,CAAC;EACjC,MAAMM,GAAG,GAAGD,OAAO,CAACvH,IAAI,CAAC;EACzB,IAAIwH,GAAG,CAAChF,MAAM,GAAG,CAAC,EAAE;IAClBxC,IAAI,GAAGA,IAAI,CAACkG,KAAK,CAAC,CAAC,EAAE,CAACsB,GAAG,CAAChF,MAAM,CAAC;;EAEnC,OAAOxC,IAAI;AACb;AAEO,SAASI,SAASA,CACvBqH,SAAoC,EACpCtH,QAA4B,EAC5BuH,cAAuB,EACvB;EACA,MAAM;IAACC,GAAG;IAAEC;GAAU,GAAGV,OAAO,CAAC,MAAM,CAAC;EACxC,MAAMW,OAAO,GAAG,CAAC1H,QAAQ,IAAI,EAAE,EAAE2H,OAAO,CAACL,SAAS,IAAI,EAAE,EAAE,EAAE,CAAC;EAC7D,IAAIM,aAAa,GAAGH,SAAS,CAACC,OAAO,CAAC,CAACG,KAAK,CAACL,GAAG,CAAC;EACjD,IAAID,cAAc,IAAIK,aAAa,CAACvF,MAAM,GAAG,CAAC,IAAIuF,aAAa,CAAC,CAAC,CAAC,KAAK,EAAE,EAAE;IACzEA,aAAa,GAAGA,aAAa,CAAC7B,KAAK,CAAC,CAAC,CAAC;;EAExC,MAAM+B,cAAc,GAAGF,aAAa,CAACG,IAAI,CAAC,GAAG,CAAC;EAC9C,OAAOD,cAAc;AACvB;AACA;AACA;AACA;AACO,SAAS/C,gBAAgBA,CAC9BuC,SAAoC,EACpCtH,QAA4B,EAC5BgI,OAAe,EACfhD,IAAY,EACZC,MAAc,EACdV,SAAkB,EAClB;EACA,MAAMuD,cAAc,GAAG7H,SAAS,CAACqH,SAAS,EAAEtH,QAAQ,EAAE,KAAK,CAAC;EAC5D,MAAMiI,QAAQ,GAAG1D,SAAS,GAAG,IAAIuD,cAAc,IAAIE,OAAO,EAAE,GAAG,EAAE;EACjE,OACEE,QAAQ,CAAC,GAAGF,OAAO,IAAIF,cAAc,KAAK9C,IAAI,KAAKC,MAAM,GAAG,CAAC,GAAGgD,QAAQ;AAE5E;AAEA,SAASC,QAAQA,CAACC,CAAS,EAAE;EAC3B,IAAIC,CAAC,GAAG,CAAC;EACT,IAAIhG,CAAC,GAAG,CAAC;EACT,IAAI+F,CAAC,CAAC9F,MAAM,GAAG,CAAC,EACd,OAAOD,CAAC,GAAG+F,CAAC,CAAC9F,MAAM,EAAE+F,CAAC,GAAI,CAACA,CAAC,IAAI,CAAC,IAAIA,CAAC,GAAGD,CAAC,CAACE,UAAU,CAACjG,CAAC,EAAE,CAAC,GAAI,CAAC;EACjE,OAAOgG,CAAC,CAACE,QAAQ,CAAC,EAAE,CAAC;AACvB;AAEO,SAAS7E,QAAQA,CACtB7D,CAAgC,EAChC2I,KAAa,EACbC,OAAiC,EACjC;EACA,OAAO5I,CAAC,CAAC6I,cAAc,CAAC7I,CAAC,CAAC0B,UAAU,CAACiH,KAAK,CAAC,EAAEC,OAAO,CAAC;AACvD;AAEA,SAAS1D,cAAcA,CACrBlF,CAAgC,EAChC2I,KAAa,EACbtG,KAAa,EACb;EACA,OAAOwB,QAAQ,CAAC7D,CAAC,EAAE2I,KAAK,EAAE3I,CAAC,CAACiB,aAAa,CAACoB,KAAK,CAAC,CAAC;AACnD;AAEO,SAASf,eAAeA,CAACrB,IAAmB,EAAE;EACnD,OAAOA,IAAI,CAAC8C,IAAI,CAAC9C,IAAI,IAAIA,IAAI,CAAC6I,SAAS,EAAE,CAAC;AAC5C;;ACpcA,MAAMC,gBAAgB,GAAG,CACvB,kBAAkB,EAClB,mBAAmB,EACnB,uBAAuB,EACvB,yBAAyB,EACzB,eAAe,EACf,qBAAqB,EACrB,iBAAiB,EACjB,UAAU;AAAE,CACb;AAEM,SAASC,gBAAgBA,CAACC,OAA8B,EAAE;EAC/D,MAAMC,QAAQ,GAAGD,OAAO,CAACE,UAAU,GAC/B;IACEC,KAAK,EAAE,EAAE;IACTC,KAAK,EAAE,EAAE;IACTC,MAAM,EAAE,EAAE;IACVC,MAAM,EAAE,EAAE;IACVC,OAAO,EAAE,EAAE;IACXC,OAAO,EAAE,EAAE;IACXC,MAAM,EAAE,EAAE;IACVC,OAAO,EAAE,EAAE;IACXC,KAAK,EAAE,EAAE;IACTC,MAAM,EAAE,EAAE;IACV5B,KAAK,EAAE,EAAE;IACT6B,SAAS,EAAE,EAAE;IACbC,KAAK,EAAE,EAAE;IACTC,aAAa,EAAE;MACbZ,KAAK,EAAE,EAAE;MACTC,KAAK,EAAE,EAAE;MACTC,MAAM,EAAE,EAAE;MACVC,MAAM,EAAE;KACT;IACDU,YAAY,EAAE;MACZC,UAAU,EAAE;KACb;IACDC,SAAS,EAAE;GACZ,GACD;IACEf,KAAK,EAAE,CAAC,aAAa,CAAC;IACtBC,KAAK,EAAE,CAAC,aAAa,CAAC;IACtBC,MAAM,EAAE,CAAC,cAAc,CAAC;IACxBC,MAAM,EAAE,CAAC,cAAc,CAAC;IACxBC,OAAO,EAAE,CAAC,SAAS,CAAC;IACpBC,OAAO,EAAE,CAAC,SAAS,CAAC;IACpBC,MAAM,EAAE,CAAC,QAAQ,CAAC;IAClBC,OAAO,EAAE,CAAC,SAAS,CAAC;IACpBC,KAAK,EAAE,CAAC,OAAO,CAAC;IAChBC,MAAM,EAAE,CAAC,QAAQ,CAAC;IAClB5B,KAAK,EAAE,CAAC,OAAO,CAAC;IAChB6B,SAAS,EAAE,CAAC,WAAW,CAAC;IACxBC,KAAK,EAAE,CAAC,OAAO,CAAC;IAChBC,aAAa,EAAE;MACbZ,KAAK,EAAE,CAAC,OAAO,EAAE,aAAa,CAAC;MAC/BC,KAAK,EAAE,CAAC,OAAO,EAAE,aAAa,CAAC;MAC/BC,MAAM,EAAE,CAAC,QAAQ,EAAE,cAAc,CAAC;MAClCC,MAAM,EAAE,CAAC,QAAQ,EAAE,cAAc;KAClC;IACDU,YAAY,EAAE;MACZC,UAAU,EAAE,CAAC,YAAY;KAC1B;IACDC,SAAS,EAAEpB;GACZ;EACL,MAAMqB,UAA2C,GAAGC,eAAe,CAAC;IAClEpB,OAAO;IACP3D,UAAU,EAAE;MACVgF,QAAQ,EAAE,KAAK;MACfC,4BAA4B,EAAE,IAAI;MAClCC,UAAU,EAAE,KAAK;MACjB/J,QAAQ,EAAE,IAAI;MACdgK,MAAM,EAAE,IAAI;MACZC,MAAM,EAAE,IAAI;MACZC,OAAO,EAAE,IAAI;MACbC,OAAO,EAAE,IAAI;MACbC,QAAQ,EAAE,IAAI;MACdC,QAAQ,EAAE,IAAI;MACdC,OAAO,EAAE,IAAI;MACbC,QAAQ,EAAE,IAAI;MACdC,MAAM,EAAE,IAAI;MACZC,QAAQ,EAAE,IAAI;MACdC,MAAM,EAAE,IAAI;MACZC,IAAI,EAAE,IAAI;MACVC,MAAM,EAAE,IAAI;MACZC,KAAK,EAAE;KACR;IACDC,MAAM,EAAE;MACNC,UAAU,EAAE,IAAIC,GAAG,CACjBxC,OAAO,CAACuC,UAAU,GACdE,KAAK,CAACC,OAAO,CAAC1C,OAAO,CAACuC,UAAU,CAAC,GAC/BvC,OAAO,CAACuC,UAAU,GAClB,CAACvC,OAAO,CAACuC,UAAU,CAAC,GACtB,CACE,UAAU,EACV,iBAAiB,EACjB,eAAe,EACf,sBAAsB,EACtB,iBAAiB,EACjB,eAAe,EACf,oBAAoB,CAE5B,CAAC;MACDI,gBAAgB,EAAE;QAChBC,GAAG,EAAE,IAAIJ,GAAG,CACVK,qBAAqB,CAAC7C,OAAO,EAAE,KAAK,EAAE,CACpC,sBAAsB,EACtB,oBAAoB,CACrB,CACH,CAAC;QACD8C,KAAK,EAAE,IAAIN,GAAG,CACZK,qBAAqB,CAAC7C,OAAO,EAAE,OAAO,EAAE,CACtC,gBAAgB,EAChB,uBAAuB,CACxB,CACH;OACD;MACD+C,aAAa,EAAE,IAAIP,GAAG,CAACxC,OAAO,CAAC+C,aAAa,IAAI9C,QAAQ,CAACE,KAAK,CAAC;MAC/D6C,aAAa,EAAE,IAAIR,GAAG,CAACxC,OAAO,CAACgD,aAAa,IAAI/C,QAAQ,CAACG,KAAK,CAAC;MAC/D6C,cAAc,EAAE,IAAIT,GAAG,CAACxC,OAAO,CAACiD,cAAc,IAAIhD,QAAQ,CAACI,MAAM,CAAC;MAClE6C,cAAc,EAAE,IAAIV,GAAG,CAACxC,OAAO,CAACkD,cAAc,IAAIjD,QAAQ,CAACK,MAAM,CAAC;MAClE6C,eAAe,EAAE,IAAIX,GAAG,CAACxC,OAAO,CAACmD,eAAe,IAAIlD,QAAQ,CAACM,OAAO,CAAC;MACrE6C,eAAe,EAAE,IAAIZ,GAAG,CAACxC,OAAO,CAACoD,eAAe,IAAInD,QAAQ,CAACO,OAAO,CAAC;MACrE6C,cAAc,EAAE,IAAIb,GAAG,CAACxC,OAAO,CAACqD,cAAc,IAAIpD,QAAQ,CAACQ,MAAM,CAAC;MAClE6C,eAAe,EAAE,IAAId,GAAG,CAACxC,OAAO,CAACsD,eAAe,IAAIrD,QAAQ,CAACS,OAAO,CAAC;MACrE6C,aAAa,EAAE,IAAIf,GAAG,CAACxC,OAAO,CAACuD,aAAa,IAAItD,QAAQ,CAACU,KAAK,CAAC;MAC/D6C,cAAc,EAAE,IAAIhB,GAAG,CAACxC,OAAO,CAACwD,cAAc,IAAIvD,QAAQ,CAACW,MAAM,CAAC;MAClE6C,aAAa,EAAE,IAAIjB,GAAG,CAACxC,OAAO,CAACyD,aAAa,IAAIxD,QAAQ,CAACjB,KAAK,CAAC;MAC/D0E,WAAW,EAAE,IAAIlB,GAAG,CAACxC,OAAO,CAAC0D,WAAW,IAAIzD,QAAQ,CAACY,SAAS,CAAC;MAC/D8C,aAAa,EAAE,IAAInB,GAAG,CAACxC,OAAO,CAAC2D,aAAa,IAAI1D,QAAQ,CAACa,KAAK,CAAC;MAC/DC,aAAa,EAAE6C,eAAe,CAC5B5D,OAAO,CAACe,aAAa,EACrBd,QAAQ,CAACc,aACX,CAAC;MACDC,YAAY,EAAE4C,eAAe,CAC3B5D,OAAO,CAACgB,YAAY,EACpBf,QAAQ,CAACe,YACX,CAAC;MACDE,SAAS,EAAE,CAAC,IAAIlB,OAAO,CAACkB,SAAS,IAAI,EAAE,CAAC,EAAE,GAAGjB,QAAQ,CAACiB,SAAS,CAAC,CAAC2C,GAAG,CAClEvF,cACF,CAAC;MACDzH,MAAM,EAAEiN,OAAO,CAAC9D,OAAO,CAACnJ,MAAM,CAAC;MAC/B6E,SAAS,EAAEoI,OAAO,CAAC9D,OAAO,CAACtE,SAAS,CAAC;MACrC6F,UAAU,EAAEuC,OAAO,CAAC9D,OAAO,CAACuB,UAAU,CAAC;MACvCwC,GAAG,EAAE/D,OAAO,CAAC+D,GAAG,KAAK,MAAM,GAAG,KAAK,GAAG/D,OAAO,CAAC+D,GAAG,IAAI,KAAK;MAC1DtI,QAAQ,EACN,OAAOuE,OAAO,CAACvE,QAAQ,KAAK,WAAW,GACnCqI,OAAO,CAAC9D,OAAO,CAACvE,QAAQ,CAAC,GACzB;;GAET,CAAC;EAEF,MAAM+B,YAAY,GAAG,CACnB2D,UAAU,CAAC4B,aAAa,EACxB5B,UAAU,CAAC6B,aAAa,EACxB7B,UAAU,CAAC8B,cAAc,EACzB9B,UAAU,CAAC+B,cAAc,EACzB/B,UAAU,CAACgC,eAAe,EAC1BhC,UAAU,CAACiC,eAAe,EAC1BjC,UAAU,CAACkC,cAAc,EACzBlC,UAAU,CAACmC,eAAe,EAC1BnC,UAAU,CAACoC,aAAa,EACxBpC,UAAU,CAACqC,cAAc,EACzBrC,UAAU,CAACsC,aAAa,EACxBtC,UAAU,CAACuC,WAAW,EACtBvC,UAAU,CAACwC,aAAa,CACzB;EAED,OAAO;IACLxC,UAAU;IACV3D;GACD;AACH;AAEA,SAASqF,qBAAqBA,CAC5B7C,OAA8B,EAC9BjH,IAAqB,EACrBkH,QAAkB,EAClB;EACA,IAAI,CAACD,OAAO,IAAI,CAACA,OAAO,CAAC2C,gBAAgB,EAAE,OAAO1C,QAAQ;EAC1D,MAAM;IAAC0C;GAAiB,GAAG3C,OAAO;EAClC,MAAM5G,KAAK,GAAGuJ,gBAAgB,CAAC5J,IAAI,CAAC;EACpC,IAAIK,KAAK,EAAE;IACT,IAAIqJ,KAAK,CAACC,OAAO,CAACtJ,KAAK,CAAC,EAAE,OAAOA,KAAK,MACjC,OAAO,CAACA,KAAK,CAAC;;EAErB,OAAO6G,QAAQ;AACjB;AAEA,SAAS2D,eAAeA,CACtBI,KAA0B,GAAG,EAAE,EAC/B/D,QAAW,EACX;EACA,MAAMqC,MAAM,GAAG,EAEd;EACD,KAAK,MAAMpI,GAAG,IAAI+F,QAAQ,EAAE;IAC1BqC,MAAM,CAACpI,GAAG,CAAC,GAAG+J,eAAe,CAACD,KAAK,CAAC9J,GAAG,CAAC,EAAE+F,QAAQ,CAAC/F,GAAG,CAAC,CAAC;;EAE1D,OAAOoI,MAAM;AACf;AAEA,SAAS2B,eAAeA,CAACC,KAA2B,EAAEjE,QAAkB,EAAE;EACxE,OAAO,IAAIuC,GAAG,CAAC0B,KAAK,IAAIjE,QAAQ,CAAC;AACnC;AAEA,SAASmB,eAAeA,CAAC;EACvBpB,OAAO;EACP3D,UAAU;EACViG;AAKF,CAAC,EAAO;EACN,KAAK,MAAM1H,QAAQ,IAAIyB,UAAU,EAAE;IACjC,IAAIzB,QAAQ,IAAIoF,OAAO,EAAE;MACvBsC,MAAM,CAAC1H,QAAQ,CAAC,GAAGkJ,OAAO,CACxB9D,OAAO,CAACpF,QAAQ,CAClB,CAAC;KACF,MAAM;MACL0H,MAAM,CAAC1H,QAAQ,CAAC,GAAGyB,UAAU,CAACzB,QAAQ,CAAC;;;EAG3C,OAAO0H,MAAM;AACf;AAEO,SAAS6B,gBAAgBA,CAC9BpN,CAAgC,EAChCqN,WAAwB,EACxB;EACE5C,MAAM;EACNC,MAAM;EACNC,OAAO;EACPC,OAAO;EACPC,QAAQ;EACRC,QAAQ;EACRC,OAAO;EACPC,QAAQ;EACRC,MAAM;EACNC,QAAQ;EACRC,MAAM;EACNC,IAAI;EACJC,MAAM;EACNC,KAAK;EAELU,aAAa;EACbC,aAAa;EACbC,cAAc;EACdC,cAAc;EACdC,eAAe;EACfC,eAAe;EACfC,cAAc;EACdC,eAAe;EACfC,aAAa;EACbC,cAAc;EACdC,aAAa;EACbC,WAAW;EACXC,aAAa;EACb5C,aAAa;EACbC;AAuCF,CAAC,EACD;EACA,MAAM1H,aAA6B,GAAG,CACpC;IACEG,IAAI,EAAE+H,MAAM;IACZ9H,GAAG,EAAEqJ,aAAa;IAClBpJ,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxByE,iBAAiB,CAACvF,IAAI,EAAEC,KAAK,EAAEa,EAAE,EAAEf,CAAC,EAAEqN,WAAW,EAAE,KAAK,EAAErL,IAAI;GACjE,EACD;IACEU,IAAI,EAAEgI,MAAM;IACZ/H,GAAG,EAAEsJ,aAAa;IAClBrJ,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxBqF,iBAAiB,CAACnG,IAAI,EAAEC,KAAK,EAAEa,EAAE,EAAEf,CAAC,EAAEqN,WAAW,EAAErL,IAAI;GAC1D,EACD;IACEU,IAAI,EAAEiI,OAAO;IACbhI,GAAG,EAAEuJ,cAAc;IACnBtJ,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxBqF,iBAAiB,CAACnG,IAAI,EAAEC,KAAK,EAAEa,EAAE,EAAEf,CAAC,EAAEqN,WAAW,EAAErL,IAAI;GAC1D,EACD;IACEU,IAAI,EAAEkI,OAAO;IACbjI,GAAG,EAAEwJ,cAAc;IACnBvJ,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxBqF,iBAAiB,CAACnG,IAAI,EAAEC,KAAK,EAAEa,EAAE,EAAEf,CAAC,EAAEqN,WAAW,EAAErL,IAAI;GAC1D,EACD;IACEU,IAAI,EAAEmI,QAAQ;IACdlI,GAAG,EAAEyJ,eAAe;IACpBxJ,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxByD,mBAAmB,CAACvE,IAAI,EAAEC,KAAK,EAAEa,EAAE,EAAEf,CAAC,EAAEqN,WAAW,EAAErL,IAAI;GAC5D,EACD;IACEU,IAAI,EAAEoI,QAAQ;IACdnI,GAAG,EAAE0J,eAAe;IACpBzJ,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxB+E,sBAAsB,CAAC7F,IAAI,EAAEC,KAAK,EAAEa,EAAE,EAAEf,CAAC,EAAEqN,WAAW,EAAE,KAAK,EAAErL,IAAI;GACtE,EACD;IACEU,IAAI,EAAEqI,OAAO;IACbpI,GAAG,EAAE2J,cAAc;IACnB1J,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxB+E,sBAAsB,CAAC7F,IAAI,EAAEC,KAAK,EAAEa,EAAE,EAAEf,CAAC,EAAEqN,WAAW,EAAE,KAAK,EAAErL,IAAI;GACtE,EACD;IACEU,IAAI,EAAEsI,QAAQ;IACdrI,GAAG,EAAE4J,eAAe;IACpB3J,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxB+E,sBAAsB,CAAC7F,IAAI,EAAEC,KAAK,EAAEa,EAAE,EAAEf,CAAC,EAAEqN,WAAW,EAAE,IAAI,EAAErL,IAAI;GACrE,EACD;IACEU,IAAI,EAAEuI,MAAM;IACZtI,GAAG,EAAE6J,aAAa;IAClB5J,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxB+E,sBAAsB,CAAC7F,IAAI,EAAEC,KAAK,EAAEa,EAAE,EAAEf,CAAC,EAAEqN,WAAW,EAAE,KAAK,EAAErL,IAAI;GACtE,EACD;IACEU,IAAI,EAAEwI,QAAQ;IACdvI,GAAG,EAAE8J,cAAc;IACnB7J,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxB+E,sBAAsB,CAAC7F,IAAI,EAAEC,KAAK,EAAEa,EAAE,EAAEf,CAAC,EAAEqN,WAAW,EAAE,IAAI,EAAErL,IAAI;GACrE,EACD;IACEU,IAAI,EAAEyI,MAAM;IACZxI,GAAG,EAAE+J,aAAa;IAClB9J,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxB+E,sBAAsB,CAAC7F,IAAI,EAAEC,KAAK,EAAE,IAAI,EAAEF,CAAC,EAAEqN,WAAW,EAAE,KAAK,EAAErL,IAAI;GACxE,EACD;IACEU,IAAI,EAAE0I,IAAI;IACVzI,GAAG,EAAEgK,WAAW;IAChB/J,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxB+E,sBAAsB,CAAC7F,IAAI,EAAEC,KAAK,EAAE,IAAI,EAAEF,CAAC,EAAEqN,WAAW,EAAE,KAAK,EAAErL,IAAI;GACxE,EACD;IACEU,IAAI,EAAE2I,MAAM;IACZ1I,GAAG,EAAEiK,aAAa;IAClBhK,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxByE,iBAAiB,CAACvF,IAAI,EAAEC,KAAK,EAAEa,EAAE,EAAEf,CAAC,EAAEqN,WAAW,EAAE,KAAK,EAAErL,IAAI;GACjE,CACF;EACD,MAAMsL,mBAAmC,GAAG,CAC1C;IACE5K,IAAI,EAAE+H,MAAM;IACZ9H,GAAG,EAAEqH,aAAa,CAACZ,KAAK;IACxBxG,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxByE,iBAAiB,CAACvF,IAAI,EAAEC,KAAK,EAAEa,EAAE,EAAEf,CAAC,EAAEqN,WAAW,EAAE,KAAK;GAC3D,EACD;IACE3K,IAAI,EAAEgI,MAAM;IACZ/H,GAAG,EAAEqH,aAAa,CAACX,KAAK;IACxBzG,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxBqF,iBAAiB,CAACnG,IAAI,EAAEC,KAAK,EAAEa,EAAE,EAAEf,CAAC,EAAEqN,WAAW;GACpD,EACD;IACE3K,IAAI,EAAEiI,OAAO;IACbhI,GAAG,EAAEqH,aAAa,CAACV,MAAM;IACzB1G,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxBqF,iBAAiB,CAACnG,IAAI,EAAEC,KAAK,EAAEa,EAAE,EAAEf,CAAC,EAAEqN,WAAW;GACpD,EACD;IACE3K,IAAI,EAAEkI,OAAO;IACbjI,GAAG,EAAEqH,aAAa,CAACT,MAAM;IACzB3G,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxBqF,iBAAiB,CAACnG,IAAI,EAAEC,KAAK,EAAEa,EAAE,EAAEf,CAAC,EAAEqN,WAAW;GACpD,CACF;EACD,MAAME,kBAAkC,GAAG,CACzC;IACE7K,IAAI,EAAE4I,KAAK;IACX3I,GAAG,EAAEsH,YAAY,CAACC,UAAU;IAC5BtH,EAAE,EAAEA,CAAC3C,IAAI,EAAEC,KAAK,EAAE8B,IAAI,EAAEjB,EAAE,KACxB+E,sBAAsB,CACpB7F,IAAI,EACJC,KAAK,EACLa,EAAE,EACFf,CAAC,EACDqN,WAAW,EACX,KAAK,EACLrL,IAAI,EACJ,IACF;GACH,CACF;EACD,OAAO;IACLO,aAAa;IACb+K,mBAAmB;IACnBC;GACD;AACH;;AClbO,SAASC,mBAAmBA,CACjCxN,CAAgC,EAChCgC,IAAY,EACZuL,kBAAkC,EAClC/C,UAAmB,EACnBvK,IAA8B,EAC9BC,KAAkB,EAClB;EACAoC,kBAAkB,CAACiL,kBAAkB,EAAEtN,IAAI,EAAEC,KAAK,EAAE8B,IAAI,CAAC;EACzDyL,wBAAwB,CAACzN,CAAC,EAAEgC,IAAI,EAAEwI,UAAU,EAAEvK,IAAI,EAAEC,KAAK,CAAC;AAC5D;AAEA,SAASuN,wBAAwBA,CAC/BzN,CAAgC,EAChCgC,IAAY,EACZwI,UAAmB,EACnBvK,IAA8B,EAC9BC,KAAkB,EAClB;EACA,IAAI,CAACsK,UAAU,IAAI,CAACtK,KAAK,CAACwN,6BAA6B,CAAC7K,GAAG,CAACb,IAAI,CAAC,EAAE;EACnE,MAAM2D,OAAO,GAAG1F,IAAI,CAACS,KAAK,CAACkF,UAAU,CAAC5D,IAAI,CAAC;EAC3C,IAAI,CAAC2D,OAAO,IAAI,CAAC3F,CAAC,CAAC2N,iBAAiB,CAAChI,OAAO,CAAC1F,IAAI,CAACiC,IAAI,CAAC,EAAE;EACzD,MAAM0L,QAAQ,GAAG3L,eAAe,CAACjC,CAAC,EAAE2F,OAAO,CAAC1F,IAAI,CAACiC,IAAI,CAAC;EAEtD,QAAQ0L,QAAQ;IACd,KAAK,UAAU;IACf,KAAK,UAAU;IACf,KAAK,SAAS;MAAE;QACd,IAAI,CAACC,iBAAiB,CAAC5N,IAAI,CAAC,EAAE;UAC5B6N,sBAAsB,CAAC9N,CAAC,EAAEC,IAAI,CAAC;;QAEjC;;IAGF,KAAK,SAAS;MAAE;QACd,IAAI,CAAC8N,gBAAgB,CAAC9N,IAAI,CAAC,EAAE;UAC3B6N,sBAAsB,CAAC9N,CAAC,EAAEC,IAAI,CAAC;;QAEjC;;IAGF,KAAK,SAAS;MAAE;QACd,IAAI,CAAC8N,gBAAgB,CAAC9N,IAAI,CAAC,EAAE;;UAE3B,IAAI,CAAC4N,iBAAiB,CAAC5N,IAAI,CAAC,EAAE;YAC5BA,IAAI,CAACiC,IAAI,CAACoC,SAAS,CAACxD,IAAI,CAACd,CAAC,CAACgE,gBAAgB,CAAC,EAAE,CAAC,CAAC;;;UAGlD8J,sBAAsB,CAAC9N,CAAC,EAAEC,IAAI,CAAC;;QAEjC;;IAGF,KAAK,aAAa;MAAE;QAClB,IAAI4N,iBAAiB,CAAC5N,IAAI,CAAC,EAAE;UAC3B,MAAM+N,MAAM,GAAGC,wBAAwB,CAACjO,CAAC,EAAEC,IAAI,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;UACjEA,IAAI,CAACiC,IAAI,CAACoC,SAAS,GAAG,CAAC0J,MAAM,CAAC;;;UAG9BA,MAAM,CAAC1I,UAAU,CAACxE,IAAI,CAAC+C,QAAQ,CAAC7D,CAAC,EAAE,MAAM,EAAEA,CAAC,CAACkG,eAAe,EAAE,CAAC,CAAC;;UAEhE8H,MAAM,CAAC1I,UAAU,CAACxE,IAAI,CACpB+C,QAAQ,CAAC7D,CAAC,EAAE,YAAY,EAAEA,CAAC,CAACkO,cAAc,CAAC,IAAI,CAAC,CAClD,CAAC;SACF,MAAM;UACL,MAAMC,QAAQ,GAAGlO,IAAI,CAACiC,IAAI,CAACoC,SAAS,CAAC,CAAC,CAAC;UACvC,IACEtE,CAAC,CAACoO,kBAAkB,CAACD,QAAQ,CAAC,IAC9B,CAACE,mBAAmB,CAACrO,CAAC,EAAEmO,QAAQ,EAAE,YAAY,CAAC,EAC/C;YACAA,QAAQ,CAAC7I,UAAU,CAACxE,IAAI,CACtB+C,QAAQ,CAAC7D,CAAC,EAAE,YAAY,EAAEA,CAAC,CAACkO,cAAc,CAAC,IAAI,CAAC,CAClD,CAAC;;;QAGL;;;AAGN;AAEA,SAASL,iBAAiBA,CAAC5N,IAA8B,EAAE;EACzD,OAAOA,IAAI,CAACiC,IAAI,CAACoC,SAAS,CAAC7B,MAAM,IAAI,CAAC;AACxC;AAEA,SAASqL,sBAAsBA,CAC7B9N,CAAgC,EAChCC,IAA8B,EAC9B;EACAA,IAAI,CAACiC,IAAI,CAACoC,SAAS,CAACxD,IAAI,CACtBd,CAAC,CAACgE,gBAAgB,CAAC,CAACH,QAAQ,CAAC7D,CAAC,EAAE,YAAY,EAAEA,CAAC,CAACkO,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,CACxE,CAAC;AACH;AAEA,SAASH,gBAAgBA,CAAC9N,IAA8B,EAAE;EACxD,OAAOA,IAAI,CAACiC,IAAI,CAACoC,SAAS,CAAC7B,MAAM,IAAI,CAAC;AACxC;AAEA,SAASwL,wBAAwBA,CAC/BjO,CAAgC,EAChCC,IAA8B,EAC9BqO,eAAyB,EACzB;EACA,MAAMC,gBAAgB,GAAGD,eAAe,CAACxB,GAAG,CAAC,CAAC0B,OAAO,EAAEC,KAAK,KAC1DzO,CAAC,CAAC6I,cAAc,CACd7I,CAAC,CAAC0B,UAAU,CAAC8M,OAAO,CAAC,EACrBxO,CAAC,CAAC0O,SAAS,CAACzO,IAAI,CAACiC,IAAI,CAACoC,SAAS,CAACmK,KAAK,CAAC,CACxC,CACF,CAAC;EACD,OAAOzO,CAAC,CAACgE,gBAAgB,CAACuK,gBAAgB,CAAC;AAC7C;AAEA,SAASF,mBAAmBA,CAC1BrO,CAAgC,EAChC2O,UAA4B,EAC5BC,YAAoB,EACpB;EACA,OAAOD,UAAU,CAACrJ,UAAU,CAACuJ,IAAI,CAC/BhL,QAAQ,IACN,CAAC7D,CAAC,CAAC8O,eAAe,CAACjL,QAAQ,CAAC,IAC5B7D,CAAC,CAACmC,YAAY,CAAC0B,QAAQ,CAACV,GAAG,CAAC,IAC5BU,QAAQ,CAACV,GAAG,CAACnB,IAAI,KAAK4M,YAC1B,CAAC;AACH;;ACrHO,SAASG,gBAAgBA,CAC9B/O,CAAgC,EAChCC,IAAmE,EACnEC,KAAkB,EAClB8O,aAAsB,EACtBrK,SAAkB,EAClB7E,MAAe,EACf4E,QAAiB,EACjBuK,eAAgC,EAChC;EACA,MAAM/M,IAAuD,GAAGjC,IAAI,CAACiC,IAAI;EACzE,MAAMgN,gBAAgB,GAAGlP,CAAC,CAACmP,0BAA0B,CAACjN,IAAI,CAAC;EAC3D,MAAMkN,MAAM,GAAGF,gBAAgB,GAAGhN,IAAI,CAACmN,GAAG,GAAGnN,IAAI,CAACkN,MAAM;EACxD,IAAI,CAACpP,CAAC,CAACmC,YAAY,CAACiN,MAAM,CAAC,EAAE;EAC7B,MAAMpN,IAAI,GAAGoN,MAAM,CAACpN,IAAI;EACxB,IACE,CAACgN,aAAa,IACd9M,IAAI,CAACoN,kBAAkB,IACvB,CAACpP,KAAK,CAACqP,mBAAmB,CAAC1M,GAAG,CAACb,IAAI,CAAC,EACpC;IACA;;EAGF,MAAMwN,qBAAqB,GAAGtO,SAAS,CACrClB,CAAC,EACDC,IAAI,EACJ,aAAa,EACbC,KAAK,CAACuP,oBACR,CAAC;EACD,MAAM;IAAClJ;GAAa,GAAGrG,KAAK,CAACqP,mBAAmB,CAACG,GAAG,CAAC1N,IAAI,CAAE;EAC3DE,IAAI,CAACoN,kBAAkB,GAAG,IAAI;EAC9B,MAAMK,MAAM,GAAG7M,8BAA8B,CAAC7C,IAAI,CAAC;EACnD,MAAM2P,UAAU,GAAGD,MAAM,GAAGA,MAAM,CAAC3N,IAAI,GAAG,EAAE;EAC5C,MAAM6N,UAAU,GAAGX,gBAAgB,GAC/BlP,CAAC,CAACmP,0BAA0B,GAC5BnP,CAAC,CAACoE,gBAAgB;EACtB,IAAIF,GAA+C;EACnDjE,IAAI,CAAC8C,IAAI,CAAC9C,IAAI,IAAI;IAChB,IAAI4P,UAAU,CAAC5P,IAAI,CAACiC,IAAI,CAAC,EAAE;MACzB,IAAIjC,IAAI,CAACiC,IAAI,CAACgC,GAAG,EAAE;QACjBA,GAAG,GAAGjE,IAAI,CAACiC,IAAI,CAACgC,GAAG,CAACK,KAAK;;MAE3B,OAAO,IAAI;;IAEb,OAAO,KAAK;GACb,CAAC;EACF,MAAMuL,GAAG,GAAG3K,gBAAgB,CAC1BjF,KAAK,CAACI,IAAI,CAACC,IAAI,CAACC,IAAI,EACpBN,KAAK,CAACO,QAAQ,EACdmP,UAAU,EACV1L,GAAG,CAAEkB,IAAI,EACTlB,GAAG,CAAEmB,MAAM,EACXV,SACF,CAAC;EACD,MAAMoL,aAA6C,GAAG;IACpDC,GAAG,EAAEC,IAAI,CAACC,SAAS,CAACJ,GAAG,CAAC;IACxBK,EAAE,EAAEjO,IAAI;IACRkO,OAAO,EAAEZ;GACV;EACD,IAAI1P,MAAM,IAAI4E,QAAQ,EAAE;IACtBqL,aAAa,CAACM,IAAI,GAAGJ,IAAI,CAACC,SAAS,CACjC,CAACN,UAAU,IAAIA,UAAU,KAAK,EAAE,GAAG,MAAM,GAAGA,UAC9C,CAAC;IACDG,aAAa,CAACO,MAAM,GAAGL,IAAI,CAACC,SAAS,CAAC3J,YAAY,CAAC;;EAErD,IAAIzG,MAAM,EAAE;IACViQ,aAAa,CAACQ,GAAG,GAAGjN,SAAS,CAC3BpD,KAAK,CAACC,kBAAkB,EACxB+D,GAAG,CAAEkB,IAAI,EACTlB,GAAG,CAAEmB,MAAM,EACXrF,CACF,CAAC;;EAEHC,IAAI,CAACuQ,WAAW,CAACvB,eAAe,CAACc,aAAa,CAAC,CAAC;AAClD;;AC/EO,SAASU,wBAAwBA,CACtCzQ,CAAgC,EAChCsN,mBAAmC,EACnC/C,4BAAqC,EACrCtK,IAA8B,EAC9BC,KAAkB,EAClB;EACA,IACEqK,4BAA4B,IAC5BvK,CAAC,CAAC0Q,kBAAkB,CAACzQ,IAAI,CAACiC,IAAI,CAACkN,MAAM,CAAC,IACtC,MAAM,IAAInP,IAAI,CAACiC,IAAI,CAACkN,MAAM,CAACvL,QAAQ,EACnC;IACAvB,kBAAkB,CAChBgL,mBAAmB,EACnBrN,IAAI,EACJC,KAAK,EACLD,IAAI,CAACiC,IAAI,CAACkN,MAAM,CAACvL,QAAQ,CAAC7B,IAC5B,CAAC;;AAEL;;ACXA,MAAM2O,qBAAqB,GAAG,CAC5B,KAAK,EACL,QAAQ,EACR,WAAW,EACX,WAAW,EACX,IAAI,EACJ,OAAO,EACP,OAAO,EACP,SAAS,CACV;AAED,MAAMC,eAAe,GAAG,CACtB,qBAAqB,EACrB,yBAAyB,EACzB,0BAA0B,EAC1B,kBAAkB,CACnB;AAEM,SAASC,YAAYA,CAC1B7Q,CAAgC,EAChCC,IAAuB,EACvBkK,SAAmB,EACnB/I,cAA8B,EAC9B0P,OAAqB,EACrBC,eAAwC,EACxCC,gBAAoC,EACpCC,aAA8B,EAC9B;EACA,MAAMC,gBAAgB,GAAG,IAAIzF,GAAG,CAACkF,qBAAqB,CAAC;EAEvD1Q,IAAI,CAACkR,QAAQ,CAAC;IACZC,iBAAiBA,CAACC,WAAW,EAAE;MAC7B,MAAMxK,MAAM,GAAGwK,WAAW,CAACnP,IAAI,CAAC2E,MAAM,CAACxE,KAAK;MAC5C,MAAMN,UAAU,GAAGsP,WAAW,CAACnP,IAAI,CAACH,UAAU,CAAC+K,GAAG,CAChDtL,SAAS,IAAIA,SAAS,CAAC8P,KAAK,CAACtP,IAC/B,CAAC;MAED,IAAI,CAAC,CAAC,UAAU,EAAE,GAAGmI,SAAS,CAAC,CAACoH,QAAQ,CAAC1K,MAAM,CAAC,EAAE;QAChD;;MAGF,KAAK,MAAMrF,SAAS,IAAIO,UAAU,EAAE;QAClCmP,gBAAgB,CAACvK,GAAG,CAACnF,SAAS,CAAC;;MAGjC,IAAIqF,MAAM,KAAK,UAAU,EAAE;QACzB;;KAEH;IACD2K,cAAcA,CAACvR,IAAI,EAAE;MACnBwR,iBAAiB,CACfzR,CAAC,EACDC,IAAI,EACJA,IAAI,CAACiC,IAAI,CAACkN,MAAM,EAChB8B,gBAAgB,EAChB9P,cAAc,EACd0P,OAAO,EACPC,eAAe,EACfC,gBAAgB,EAChBC,aACF,CAAC;KACF;IACDS,wBAAwBA,CAACzR,IAAI,EAAE;MAC7BwR,iBAAiB,CACfzR,CAAC,EACDC,IAAI,EACJA,IAAI,CAACiC,IAAI,CAACmN,GAAG,EACb6B,gBAAgB,EAChB9P,cAAc,EACd0P,OAAO,EACPC,eAAe,EACfC,gBAAgB,EAChBC,aACF,CAAC;;GAEJ,CAAC;AACJ;AAEA,SAASQ,iBAAiBA,CACxBzR,CAAgC,EAChCC,IAAmE,EACnEmP,MAAkE,EAClE8B,gBAA6B,EAC7B9P,cAA8B,EAC9B0P,OAAqB,EACrBC,eAAwC,EACxCC,gBAAoC,EACpCC,aAA8B,EAC9B;EACA,IAAI,CAACU,YAAY,CAAC1R,IAAI,EAAEmP,MAAM,EAAE8B,gBAAgB,CAAC,EAAE;IACjD;;EAEF,IAAI,CAAC9P,cAAc,CAACwQ,iBAAiB,EAAE;IACrC,MAAMC,cAAc,GAAG3Q,SAAS,CAAClB,CAAC,EAAEC,IAAI,EAAE,YAAY,EAAEmB,cAAc,CAAC;IACvE,MAAM0Q,UAAU,GAAGf,eAAe,CAAC;MACjCgB,WAAW,EAAEF,cAAc;MAC3BjS;KACD,CAAC;;IAEFwB,cAAc,CAACU,qBAAqB,CAAEkQ,WAAW,CAACF,UAAU,CAAC;IAC7D1Q,cAAc,CAACwQ,iBAAiB,GAAG,IAAI;;EAEzC,IAAI,CAACxQ,cAAc,CAAC6Q,eAAe,EAAE;IACnC,MAAMC,OAAO,GAAGjB,aAAa,CAAC7P,cAAc,EAAEnB,IAAI,EAAE6Q,OAAO,CAAC;IAC5D,MAAMzP,WAAW,GAAGC,eAAe,CAACrB,IAAI,CAAC;IACzCoB,WAAW,CAAC8Q,aAAa,CAAC,MAAM,EAAED,OAAO,CAAC;IAC1C9Q,cAAc,CAAC6Q,eAAe,GAAG,IAAI;;EAEvChS,IAAI,CAACuQ,WAAW,CACdQ,gBAAgB,CAAC;IACfoB,WAAW,EAAElR,SAAS,CAAClB,CAAC,EAAEC,IAAI,EAAE,YAAY,EAAEmB,cAAc,CAAC;IAC7DxB,WAAW;IACXuQ,EAAE,EAAElQ,IAAI,CAACiC;GACV,CACH,CAAC;AACH;AAEA,SAASyP,YAAYA,CACnB1R,IAAmB,EACnBmP,MAAkE,EAClE8B,gBAA6B,EAC7B;EAAA,IAAAmB,SAAA;;EAEA,IACE,EAAE,MAAM,IAAIjD,MAAM,CAAC,IACnB,EAAGA,MAAM,CAASvL,QAAQ,IAAKuL,MAAM,CAASvL,QAAQ,CAAC7B,IAAI,CAAC,EAC5D;IACA,OAAO,KAAK;;EAEd,MAAMA,IAAI,GAAIoN,MAAM,CAASpN,IAAI,MAAAqQ,SAAA,GAAKjD,MAAM,CAASvL,QAAQ,cAAAwO,SAAA,uBAAxBA,SAAA,CAA0BrQ,IAAI;EACnE,IAAI,CAACkP,gBAAgB,CAACrO,GAAG,CAACb,IAAI,CAAC,EAAE;IAC/B,OAAO,KAAK;;EAEd,OAAO,CAAC/B,IAAI,CAACqS,UAAU,CACrBC,MAAM,IAAIA,MAAM,IAAI3B,eAAe,CAACW,QAAQ,CAACgB,MAAM,CAACrQ,IAAI,CAACsQ,IAAI,CAC/D,CAAC;AACH;;AC3IO,SAASC,qBAAqBA,CACnCC,QAAkD,EAClD5S,MAAe,EACf4E,QAAiB,EACA;EACjB,IAAIuK,eAAuC,GAAG,IAAI;EAClD,OAAO9K,IAAI,IAAI;IACb,IAAI,CAAC8K,eAAe,EAAE;MACpBA,eAAe,GAAGyD,QAAQ,CACxB5S,MAAM,GACF,+DAA+D,GAC/D4E,QAAQ,GACR,uDAAuD,GACvD,+BACN,CAA2B;;IAE7B,OAAOuK,eAAe,CAAC9K,IAAI,CAAC;GAC7B;AACH;AAEO,SAASwO,wBAAwBA,CACtCD,QAAkD,EAC9B;EACpB,IAAIE,kBAA6C,GAAG,IAAI;EACxD,OAAOzO,IAAI,IAAI;IACb,IAAI,CAACyO,kBAAkB,EAAE;MACvBA,kBAAkB,GAAGF,QAAQ,CAC3B,oCACF,CAA8B;;IAEhC,OAAOE,kBAAkB,CAACzO,IAAI,CAAC;GAChC;AACH;AAEO,SAAS0O,uBAAuBA,CACrCH,QAAkD,EACzB;EACzB,IAAII,iBAAiD,GAAG,IAAI;EAC5D,OAAO3O,IAAI,IAAI;IACb,IAAI,CAAC2O,iBAAiB,EAAE;MACtBA,iBAAiB,GAAGJ,QAAQ,CAC1B,mDACF,CAAmC;;IAErC,OAAOI,iBAAiB,CAAC3O,IAAI,CAAC;GAC/B;AACH;AAEO,SAAS4O,qBAAqBA,CACnCL,QAAkD,EAClD1S,CAAgC,EACf;EACjB,IAAIgT,WAAgC;EACpC,IAAIC,eAA6C,GAAG,IAAI;EACxD,OAAO,CAAC7R,cAAc,EAAEiQ,WAAW,EAAEP,OAAO,KAAK;IAC/C,IAAI,CAACkC,WAAW,EAAE;MAChBA,WAAW,GAAGN,QAAQ,CAACQ,UAAU,CAACC,GAAG,CACnCrC,OAAO,KAAK,KAAK,GACb,YAAY,GACZ,6CACN,CAA+B;;IAEjC,IAAI,CAACmC,eAAe,EAAE;MACpBA,eAAe,GAAGP,QAAQ,CAAC;AACjC;AACA;AACA;AACA;AACA;AACA,OAAO,CAAiC;;IAEpC,OAAOO,eAAe,CAAC;MACrBG,YAAY,EAAEJ,WAAW;MACzBK,UAAU,EAAEnS,SAAS,CAAClB,CAAC,EAAEqR,WAAW,EAAE,WAAW,EAAEjQ,cAAc,CAAC;MAClExB;KACD,CAAC;GACH;AACH;;AC1De,SAAS0T,mBAAmBA,CACzCC,KAAmC,EACnCtK,OAA8B,GAAG,EAAE,EACnC;EACA,MAAM;IAACmB,UAAU;IAAE3D;GAAa,GAAGuC,gBAAgB,CAACC,OAAO,CAAC;EAC5D,MAAM;IACJvE,QAAQ;IACR5E,MAAM;IACN6E,SAAS;IACT4F,4BAA4B;IAC5ByC,GAAG;IACHvM,QAAQ,EAAEV,cAAc;IACxBkK,YAAY;IACZE,SAAS;IACTqB,UAAU;IACVI,gBAAgB;IAChBtB,QAAQ;IACRE;GACD,GAAGJ,UAAU;EACd,IAAIE,QAAQ,EAAE;IACZkJ,OAAO,CAACC,KAAK,CACX,qHACF,CAAC;;EAEH,MAAMzE,aAAa,GAAG7E,SAAS,CAAC1H,MAAM,GAAG,CAAC;EAC1C,MAAMiR,oBAAoB,GAAGvJ,SAAS,CAAC0E,IAAI,CACzC8E,GAAG,IAAIA,GAAG,CAAC3M,UAAU,CAAC,IAAI,CAAC,IAAI2M,GAAG,CAAC3M,UAAU,CAAC,KAAK,CACrD,CAAC;EAED,MAAMqG,WAAwB,GAAG;IAACvN,MAAM;IAAE4E,QAAQ;IAAEC;GAAU;EAC9D,MAAM;IAACiP,KAAK,EAAE5T,CAAC;IAAE0S;GAAS,GAAGa,KAAK;EAClC,MAAMtE,eAAe,GAAGwD,qBAAqB,CAACC,QAAQ,EAAE5S,MAAM,EAAE4E,QAAQ,CAAC;EACzE,MAAMoO,iBAAiB,GAAGD,uBAAuB,CAACH,QAAQ,CAAC;EAC3D,MAAME,kBAAkB,GAAGD,wBAAwB,CAACD,QAAQ,CAAC;EAC7D,MAAMO,eAAe,GAAGF,qBAAqB,CAACL,QAAQ,EAAE1S,CAAC,CAAC;EAE1D,MAAM;IAACuC,aAAa;IAAEgL,kBAAkB;IAAED;GAAoB,GAC5DF,gBAAgB,CAACpN,CAAC,EAAEqN,WAAW,EAAEjD,UAAU,CAAC;EAE9C,MAAMyJ,aAAmC,GAAG;IAC1CzC,iBAAiBA,CAACnR,IAAI,EAAEC,KAAK,EAAE;MAC7B,MAAM2G,MAAM,GAAG5G,IAAI,CAACiC,IAAI,CAAC2E,MAAM,CAACxE,KAAK;MACrC,MAAMN,UAAU,GAAG9B,IAAI,CAACiC,IAAI,CAACH,UAAU;MACvC,IAAIyJ,UAAU,CAAC3I,GAAG,CAACgE,MAAM,CAAC,EAAE;QAC1B,KAAK,IAAIrE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGT,UAAU,CAACU,MAAM,EAAED,CAAC,EAAE,EAAE;UAC1C,MAAM+F,CAAC,GAAGxG,UAAU,CAACS,CAAC,CAAC;UACvB,IAAI,CAACxC,CAAC,CAAC2N,iBAAiB,CAACpF,CAAC,CAAC,EAAE;UAC7B,MAAMhC,YAAY,GAAGtE,eAAe,CAACjC,CAAC,EAAEuI,CAAC,CAAC;UAC1C,MAAM/B,SAAS,GAAG+B,CAAC,CAAC+I,KAAK,CAACtP,IAAI;UAC9B,IAAIuE,YAAY,KAAKC,SAAS,EAAE;UAChCF,iBAAiB,CAACC,YAAY,EAAEC,SAAS,EAAEC,YAAY,CAAC;;OAE3D,MAAM,IACLmF,gBAAgB,CAACC,GAAG,CAAChJ,GAAG,CAACgE,MAAM,CAAC,IAChC+E,gBAAgB,CAACG,KAAK,CAAClJ,GAAG,CAACgE,MAAM,CAAC,EAClC;QACA,KAAK,IAAIrE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGT,UAAU,CAACU,MAAM,EAAED,CAAC,EAAE,EAAE;UAC1C,MAAM+F,CAAC,GAAGxG,UAAU,CAACS,CAAC,CAAC;UACvB,IAAI,CAACxC,CAAC,CAAC2N,iBAAiB,CAACpF,CAAC,CAAC,EAAE;UAC7B,MAAMhC,YAAY,GAAGtE,eAAe,CAACjC,CAAC,EAAEuI,CAAC,CAAC;UAC1C,MAAM/B,SAAS,GAAG+B,CAAC,CAAC+I,KAAK,CAACtP,IAAI;;;UAG9B,IAAI4J,gBAAgB,CAACG,KAAK,CAAClJ,GAAG,CAACgE,MAAM,CAAC,EAAE;YACtC,IAAI,CAAC6G,6BAA6B,CAAC/G,GAAG,CAACH,SAAS,CAAC;;UAGnD,IAAID,YAAY,KAAKC,SAAS,EAAE;UAChC,IAAIyD,YAAY,CAACC,UAAU,CAACrH,GAAG,CAAC0D,YAAY,CAAC,EAAE;YAC7C0D,YAAY,CAACC,UAAU,CAACvD,GAAG,CAACH,SAAS,CAAC;;;OAG3C,MAAM;QACL,KAAK,IAAIhE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGT,UAAU,CAACU,MAAM,EAAED,CAAC,EAAE,EAAE;UAC1C,MAAM+F,CAAC,GAAGxG,UAAU,CAACS,CAAC,CAAC;UACvB,IAAIxC,CAAC,CAAC8T,0BAA0B,CAACvL,CAAC,CAAC,EAAE;UACrC,MAAM/B,SAAS,GAAG+B,CAAC,CAAC+I,KAAK,CAACtP,IAAI;UAC9B,IAAIyE,YAAY,CAACoI,IAAI,CAAClM,GAAG,IAAIA,GAAG,CAACE,GAAG,CAAC2D,SAAS,CAAC,CAAC,EAAE;YAChD,IAAI,CAACuN,uBAAuB,CAACpN,GAAG,CAACH,SAAS,CAAC;;;;MAIjD,IAAI8D,QAAQ,EAAE;QACZ,IAAIzD,MAAM,KAAK,gBAAgB,IAAIA,MAAM,KAAK,uBAAuB,EAAE;UACrE5G,IAAI,CAACiC,IAAI,CAAC2E,MAAM,CAACxE,KAAK,GAAG,sBAAsB;;;MAGnD,IAAI2M,aAAa,EAAE;QACjB,MAAMlI,QAAQ,GAAG5G,KAAK,CAACI,IAAI,CAACC,IAAI,CAACC,IAAI,IAAI,EAAE;QAC3C,IAAI,CAAC,IAAI,CAACwT,qBAAqB,EAAE;UAC/B,IAAIN,oBAAoB,EAAE;YACxB,MAAM;cAACzM;aAAQ,GAAGE,OAAO,CAAC,MAAM,CAAC;YACjC,IAAI,CAAC6M,qBAAqB,GAAG7J,SAAS,CAAC2C,GAAG,CAAC6G,GAAG,IAAI;cAChD,IAAIA,GAAG,CAAC3M,UAAU,CAAC,IAAI,CAAC,IAAI2M,GAAG,CAAC3M,UAAU,CAAC,KAAK,CAAC,EAAE;gBACjD,MAAMiN,WAAW,GAAGhN,OAAO,CAACH,QAAQ,EAAE6M,GAAG,CAAC;gBAC1C,OAAOtT,SAAS,CAACyG,QAAQ,EAAEmN,WAAW,EAAE,IAAI,CAAC;;cAE/C,OAAON,GAAG;aACX,CAAC;WACH,MAAM;YACL,IAAI,CAACK,qBAAqB,GAAG7J,SAAS;;;QAG1C,MAAMpD,gBAAgB,GAAGH,eAAe,CAACC,MAAM,EAAEC,QAAQ,EAAE5G,KAAK,CAAC;QACjE,IACE,IAAI,CAAC8T,qBAAqB,CAACzC,QAAQ,CAACxK,gBAAgB,CAAC;;QAErDA,gBAAgB,CAACC,UAAU,CAAC,WAAW,CAAC,EACxC;UACA,IAAI,CAACkN,0BAA0B,GAAG,IAAI;UAEtC,KAAK,IAAI1R,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGT,UAAU,CAACU,MAAM,EAAED,CAAC,EAAE,EAAE;YAC1C,MAAM+F,CAAC,GAAGxG,UAAU,CAACS,CAAC,CAAC;YACvB,IAAIxC,CAAC,CAAC8T,0BAA0B,CAACvL,CAAC,CAAC,EAAE;YACrC,MAAMhC,YAAY,GAAGvG,CAAC,CAACmU,wBAAwB,CAAC5L,CAAC,CAAC,GAC9C,SAAS,GACTtG,eAAe,CAACjC,CAAC,EAAEuI,CAAC,CAAC;YACzB,MAAM/B,SAAS,GAAG+B,CAAC,CAAC+I,KAAK,CAACtP,IAAI;YAC9B,IAAI,CAACuN,mBAAmB,CAAC5M,GAAG,CAAC6D,SAAS,EAAE;cACtCA,SAAS;cACTD,YAAY;cACZM,MAAM,EAAEE;aACT,CAAC;;;;;GAKX;EAED,MAAMqN,MAA8B,GAAG;IACrCpS,IAAI,EAAE,uBAAuB;IAC7BqS,GAAGA,GAAG;MACJ,IAAI,CAACN,uBAAuB,GAAG,IAAItI,GAAG,EAAE;MACxC,IAAI,CAACiC,6BAA6B,GAAG,IAAIjC,GAAG,EAAE;MAC9C,IAAI,CAAC8D,mBAAmB,GAAG,IAAI+E,GAAG,EAAE;MACpC,IAAI,CAAC7E,oBAAoB,GAAG;QAC1B8E,WAAW,EAAE,IAAI;QACjBC,SAAS,EAAE,IAAI;QACfC,UAAU,EAAE,IAAI;QAChBC,UAAU,EAAE,IAAI;QAChB/S,iBAAiB,EAAE,IAAI;QACvBG,qBAAqB,EAAE,IAAI;QAC3B8P,iBAAiB,EAAE,KAAK;QACxBK,eAAe,EAAE;OAClB;KACF;IACD0C,IAAIA,GAAG;MACL,IAAI,CAACZ,uBAAuB,CAACa,KAAK,EAAE;MACpC,IAAI,CAACrF,mBAAmB,CAACqF,KAAK,EAAE;MAChC,IAAI,CAACV,0BAA0B,GAAG,KAAK;MACvC,IAAI,CAACzE,oBAAoB,GAAG;QAC1B8E,WAAW,EAAE,IAAI;QACjBC,SAAS,EAAE,IAAI;QACfC,UAAU,EAAE,IAAI;QAChBC,UAAU,EAAE,IAAI;QAChB/S,iBAAiB,EAAE,IAAI;QACvBG,qBAAqB,EAAE,IAAI;QAC3B8P,iBAAiB,EAAE,KAAK;QACxBK,eAAe,EAAE;OAClB;MACD,IAAI,IAAI,CAAC+B,qBAAqB,EAAE;QAC9B,OAAO,IAAI,CAACA,qBAAqB;;KAEpC;IACDa,OAAO,EAAE;MACPC,OAAO,EAAE;QACPC,KAAKA,CAAC9U,IAAI,EAAEC,KAAK,EAAE;UACjB,IAAI8M,GAAG,EAAE;YAAA,IAAAgI,qBAAA;YACP,MAAMlE,OAAO,GACX9D,GAAG,KAAK,KAAK,GACT,KAAK,GACLA,GAAG,KAAK,IAAI,GACZ,IAAI,GACJ,CAAC,GAAAgI,qBAAA,GAAC9U,KAAK,CAACI,IAAI,CAACC,IAAI,CAAC0U,MAAM,cAAAD,qBAAA,eAAtBA,qBAAA,CAAwBE,iBAAiB,IAC3C,IAAI,GACJ,KAAK;YACXrE,YAAY,CACV7Q,CAAC,EACDC,IAAI,EACJkK,SAAS,EACT,IAAI,CAACsF,oBAAoB,EACzBqB,OAAO,EACPgC,iBAAiB,EACjBF,kBAAkB,EAClBK,eACF,CAAC;;UAGHhT,IAAI,CAACkR,QAAQ,CAAC0C,aAAa,EAAE3T,KAAK,CAAC;;OAEtC;MACDsR,cAAcA,CAACvR,IAAI,EAAEC,KAAK,EAAE;QAC1BL,qBAAqB,CAACC,MAAM,EAAEC,cAAc,EAAEC,CAAC,EAAEC,IAAI,EAAEC,KAAK,CAAC;QAE7DuQ,wBAAwB,CACtBzQ,CAAC,EACDsN,mBAAmB,EACnB/C,4BAA4B,EAC5BtK,IAAI,EACJC,KACF,CAAC;QACD,MAAM8B,IAAI,GAAGmT,kBAAkB,CAACnV,CAAC,EAAEC,IAAI,EAAEC,KAAK,CAAC;QAC/C,IAAI8B,IAAI,EAAE;UACRwL,mBAAmB,CACjBxN,CAAC,EACDgC,IAAI,EACJuL,kBAAkB,EAClB/C,UAAU,EACVvK,IAAI,EACJC,KACF,CAAC;UACDkV,4BAA4B,CAACpT,IAAI,EAAEO,aAAa,EAAEtC,IAAI,EAAEC,KAAK,CAAC;;QAGhE6O,gBAAgB,CACd/O,CAAC,EACDC,IAAI,EACJC,KAAK,EACL8O,aAAa,EACbrK,SAAS,EACT7E,MAAM,EACN4E,QAAQ,EACRuK,eACF,CAAC;OACF;MACDyC,wBAAwBA,CAACzR,IAAI,EAAEC,KAAK,EAAE;QACpCL,qBAAqB,CAACC,MAAM,EAAEC,cAAc,EAAEC,CAAC,EAAEC,IAAI,EAAEC,KAAK,CAAC;QAE7D6O,gBAAgB,CACd/O,CAAC,EACDC,IAAI,EACJC,KAAK,EACL8O,aAAa,EACbrK,SAAS,EACT7E,MAAM,EACN4E,QAAQ,EACRuK,eACF,CAAC;;;GAGN;EACD,OAAOmF,MAAM;AACf;AAEA,SAASe,kBAAkBA,CACzBnV,CAAgC,EAChCC,IAA8B,EAC9BC,KAAkB,EAClB;EACA,IAAI,CAACF,CAAC,CAACmC,YAAY,CAAClC,IAAI,CAACiC,IAAI,CAACkN,MAAM,CAAC,EAAE,OAAO,IAAI;EAClD,MAAMpN,IAAI,GAAG/B,IAAI,CAACiC,IAAI,CAACkN,MAAM,CAACpN,IAAI;EAClC,IAAI9B,KAAK,CAAC6T,uBAAuB,CAAClR,GAAG,CAACb,IAAI,CAAC,EAAE,OAAO,IAAI;EACxD,OAAOA,IAAI;AACb;AAEA,SAASoT,4BAA4BA,CACnCpT,IAAY,EACZO,aAA6B,EAC7BtC,IAA8B,EAC9BC,KAAkB,EAClB;EACAoC,kBAAkB,CAACC,aAAa,EAAEtC,IAAI,EAAEC,KAAK,EAAE8B,IAAI,CAAC;AACtD;;;;"}